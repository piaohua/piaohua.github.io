<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Vue3 快速入手 - piaohua&#39;s blog</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="piaohua" /><meta name="description" content="Vue3 快速入手 1. Vue3简介 2020年9月18日，Vue.js发布版3.0版本，代号：One Piece（n 经历了：4800&#43;次提交、40&#43;个RF" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.67.0 with theme even" />


<link rel="canonical" href="https://piaohua.github.io/post/learn/20250830-vue3-quick-start/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.2e81bbed97b8b282c1aeb57488cc71c8d8c8ec559f3931531bd396bf31e0d4dd.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Vue3 快速入手" />
<meta property="og:description" content="Vue3 快速入手 1. Vue3简介 2020年9月18日，Vue.js发布版3.0版本，代号：One Piece（n 经历了：4800&#43;次提交、40&#43;个RF" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://piaohua.github.io/post/learn/20250830-vue3-quick-start/" />
<meta property="article:published_time" content="2025-08-30T18:36:04+08:00" />
<meta property="article:modified_time" content="2025-08-30T18:36:04+08:00" />
<meta itemprop="name" content="Vue3 快速入手">
<meta itemprop="description" content="Vue3 快速入手 1. Vue3简介 2020年9月18日，Vue.js发布版3.0版本，代号：One Piece（n 经历了：4800&#43;次提交、40&#43;个RF">
<meta itemprop="datePublished" content="2025-08-30T18:36:04&#43;08:00" />
<meta itemprop="dateModified" content="2025-08-30T18:36:04&#43;08:00" />
<meta itemprop="wordCount" content="22172">



<meta itemprop="keywords" content="vue3,typescript," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Vue3 快速入手"/>
<meta name="twitter:description" content="Vue3 快速入手 1. Vue3简介 2020年9月18日，Vue.js发布版3.0版本，代号：One Piece（n 经历了：4800&#43;次提交、40&#43;个RF"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">piaohua</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/links/">
        <li class="mobile-menu-item">Links</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">piaohua</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/links/">Links</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Vue3 快速入手</h1>

      <div class="post-meta">
        <span class="post-time"> 2025-08-30 </span>
        <div class="post-category">
            <a href="/categories/vue3/"> vue3 </a>
            </div>
          <span class="more-meta"> 22172 words </span>
          <span class="more-meta"> 45 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#11-性能的提升">1.1. 【性能的提升】</a></li>
    <li><a href="#12-源码的升级">1.2.【 源码的升级】</a></li>
    <li><a href="#13-拥抱typescript">1.3. 【拥抱TypeScript】</a></li>
    <li><a href="#14-新的特性">1.4. 【新的特性】</a></li>
  </ul>

  <ul>
    <li><a href="#21-基于-vue-cli-创建">2.1. 【基于 vue-cli 创建】</a></li>
    <li><a href="#22-基于-vite-创建推荐">2.2. 【基于 vite 创建】(推荐)</a></li>
    <li><a href="#23-一个简单的效果">2.3. 【一个简单的效果】</a></li>
  </ul>

  <ul>
    <li><a href="#31--optionsapi-与-compositionapi">3.1.  【OptionsAPI 与 CompositionAPI】</a>
      <ul>
        <li><a href="#options-api-的弊端">Options API 的弊端</a></li>
        <li><a href="#composition-api-的优势">Composition API 的优势</a></li>
      </ul>
    </li>
    <li><a href="#32-拉开序幕的-setup">3.2. 【拉开序幕的 setup】</a>
      <ul>
        <li><a href="#setup-概述">setup 概述</a></li>
        <li><a href="#setup-的返回值">setup 的返回值</a></li>
        <li><a href="#setup-与-options-api-的关系">setup 与 Options API 的关系</a></li>
        <li><a href="#setup-语法糖">setup 语法糖</a></li>
      </ul>
    </li>
    <li><a href="#33-ref-创建基本类型的响应式数据">3.3. 【ref 创建：基本类型的响应式数据】</a></li>
    <li><a href="#34-reactive-创建对象类型的响应式数据">3.4. 【reactive 创建：对象类型的响应式数据】</a></li>
    <li><a href="#35-ref-创建对象类型的响应式数据">3.5. 【ref 创建：对象类型的响应式数据】</a></li>
    <li><a href="#36-ref-对比-reactive">3.6. 【ref 对比 reactive】</a></li>
    <li><a href="#37-torefs-与-toref">3.7. 【toRefs 与 toRef】</a></li>
    <li><a href="#38-computed">3.8. 【computed】</a></li>
    <li><a href="#39watch">3.9.【watch】</a>
      <ul>
        <li><a href="#-情况一">* 情况一</a></li>
        <li><a href="#-情况二">* 情况二</a></li>
        <li><a href="#--情况三">*  情况三</a></li>
        <li><a href="#-情况四">* 情况四</a></li>
        <li><a href="#-情况五">* 情况五</a></li>
      </ul>
    </li>
    <li><a href="#310-watcheffect">3.10. 【watchEffect】</a></li>
    <li><a href="#311-标签的-ref-属性">3.11. 【标签的 ref 属性】</a></li>
    <li><a href="#312-props">3.12. 【props】</a></li>
    <li><a href="#313-生命周期">3.13. 【生命周期】</a></li>
    <li><a href="#314-自定义hook">3.14. 【自定义hook】</a></li>
  </ul>

  <ul>
    <li><a href="#41-对路由的理解">4.1. 【对路由的理解】</a></li>
    <li><a href="#42-基本切换效果">4.2. 【基本切换效果】</a></li>
    <li><a href="#43-两个注意点">4.3. 【两个注意点】</a></li>
    <li><a href="#44路由器工作模式">4.4.【路由器工作模式】</a></li>
    <li><a href="#45-to的两种写法">4.5. 【to的两种写法】</a></li>
    <li><a href="#46-命名路由">4.6. 【命名路由】</a></li>
    <li><a href="#47-嵌套路由">4.7. 【嵌套路由】</a></li>
    <li><a href="#48-路由传参">4.8. 【路由传参】</a>
      <ul>
        <li><a href="#query参数">query参数</a></li>
        <li><a href="#params参数">params参数</a></li>
      </ul>
    </li>
    <li><a href="#49-路由的props配置">4.9. 【路由的props配置】</a></li>
    <li><a href="#410--replace属性">4.10. 【 replace属性】</a></li>
    <li><a href="#411-编程式导航">4.11. 【编程式导航】</a></li>
    <li><a href="#412-重定向">4.12. 【重定向】</a></li>
  </ul>

  <ul>
    <li><a href="#51准备一个效果">5.1【准备一个效果】</a></li>
    <li><a href="#52搭建-pinia-环境">5.2【搭建 pinia 环境】</a></li>
    <li><a href="#53存储读取数据">5.3【存储+读取数据】</a></li>
    <li><a href="#54修改数据三种方式">5.4.【修改数据】(三种方式)</a></li>
    <li><a href="#55storetorefs">5.5.【storeToRefs】</a></li>
    <li><a href="#56getters">5.6.【getters】</a></li>
    <li><a href="#57subscribe">5.7.【$subscribe】</a></li>
    <li><a href="#58-store组合式写法">5.8. 【store组合式写法】</a></li>
  </ul>

  <ul>
    <li><a href="#61-props">6.1. 【props】</a></li>
    <li><a href="#62-自定义事件">6.2. 【自定义事件】</a></li>
    <li><a href="#63-mitt">6.3. 【mitt】</a></li>
    <li><a href="#64v-model">6.4.【v-model】</a></li>
    <li><a href="#65attrs-">6.5.【$attrs 】</a></li>
    <li><a href="#66-refsparent">6.6. 【$refs、$parent】</a></li>
    <li><a href="#67-provideinject">6.7. 【provide、inject】</a></li>
    <li><a href="#68-pinia">6.8. 【pinia】</a></li>
    <li><a href="#69-slot">6.9. 【slot】</a>
      <ul>
        <li><a href="#1-默认插槽">1. 默认插槽</a></li>
        <li><a href="#2-具名插槽">2. 具名插槽</a></li>
        <li><a href="#3-作用域插槽">3. 作用域插槽</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#71shallowref-与-shallowreactive-">7.1.【shallowRef 与 shallowReactive 】</a>
      <ul>
        <li><a href="#shallowref"><code>shallowRef</code></a></li>
        <li><a href="#shallowreactive"><code>shallowReactive</code></a></li>
        <li><a href="#总结">总结</a></li>
      </ul>
    </li>
    <li><a href="#72readonly-与-shallowreadonly">7.2.【readonly 与 shallowReadonly】</a>
      <ul>
        <li><a href="#readonly"><strong><code>readonly</code></strong></a></li>
        <li><a href="#shallowreadonly"><strong><code>shallowReadonly</code></strong></a></li>
      </ul>
    </li>
    <li><a href="#73toraw-与-markraw">7.3.【toRaw 与 markRaw】</a>
      <ul>
        <li><a href="#toraw"><code>toRaw</code></a></li>
        <li><a href="#markraw"><code>markRaw</code></a></li>
      </ul>
    </li>
    <li><a href="#74customref">7.4.【customRef】</a></li>
  </ul>

  <ul>
    <li><a href="#81-teleport">8.1. 【Teleport】</a></li>
    <li><a href="#82-suspense">8.2. 【Suspense】</a></li>
    <li><a href="#83全局api转移到应用对象">8.3.【全局API转移到应用对象】</a></li>
    <li><a href="#84其他">8.4.【其他】</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <blockquote>
<p><a href="https://cn.vuejs.org/guide/introduction">Vue3</a> 快速入手</p>
</blockquote>
<h1 id="1-vue3简介">1. Vue3简介</h1>
<ul>
<li>2020年9月18日，<code>Vue.js</code>发布版<code>3.0</code>版本，代号：<code>One Piece</code>（n</li>
<li>经历了：<a href="https://github.com/vuejs/core/commits/main">4800+次提交</a>、<a href="https://github.com/vuejs/rfcs/tree/master/active-rfcs">40+个RFC</a>、<a href="https://github.com/vuejs/vue-next/pulls?q=is%3Apr+is%3Amerged+-author%3Aapp%2Fdependabot-preview+">600+次PR</a>、<a href="https://github.com/vuejs/core/graphs/contributors">300+贡献者</a></li>
<li>官方发版地址：<a href="https://github.com/vuejs/core/releases/tag/v3.0.0">Release v3.0.0 One Piece · vuejs/core</a></li>
<li>截止2023年10月，最新的公开版本为：<code>3.3.4</code></li>
</ul>
<p><img src="/images/1695089947298-161c1b47-eb86-42fb-b1f8-d6a4fcab8ee2.png" alt="image.png" title="image.png">
<!-- raw HTML omitted --></p>
<h2 id="11-性能的提升">1.1. 【性能的提升】</h2>
<ul>
<li>
<p>打包大小减少<code>41%</code>。</p>
</li>
<li>
<p>初次渲染快<code>55%</code>, 更新渲染快<code>133%</code>。</p>
</li>
<li>
<p>内存减少<code>54%</code>。</p>
</li>
</ul>
<h2 id="12-源码的升级">1.2.【 源码的升级】</h2>
<ul>
<li>
<p>使用<code>Proxy</code>代替<code>defineProperty</code>实现响应式。</p>
</li>
<li>
<p>重写虚拟<code>DOM</code>的实现和<code>Tree-Shaking</code>。</p>
</li>
</ul>
<h2 id="13-拥抱typescript">1.3. 【拥抱TypeScript】</h2>
<ul>
<li><code>Vue3</code>可以更好的支持<code>TypeScript</code>。</li>
</ul>
<h2 id="14-新的特性">1.4. 【新的特性】</h2>
<ol>
<li>
<p><code>Composition API</code>（组合<code>API</code>）：</p>
<ul>
<li>
<p><code>setup</code></p>
</li>
<li>
<p><code>ref</code>与<code>reactive</code></p>
</li>
<li>
<p><code>computed</code>与<code>watch</code></p>
<p>&hellip;&hellip;</p>
</li>
</ul>
</li>
<li>
<p>新的内置组件：</p>
<ul>
<li>
<p><code>Fragment</code></p>
</li>
<li>
<p><code>Teleport</code></p>
</li>
<li>
<p><code>Suspense</code></p>
<p>&hellip;&hellip;</p>
</li>
</ul>
</li>
<li>
<p>其他改变：</p>
<ul>
<li>
<p>新的生命周期钩子</p>
</li>
<li>
<p><code>data</code> 选项应始终被声明为一个函数</p>
</li>
<li>
<p>移除<code>keyCode</code>支持作为<code> v-on</code> 的修饰符</p>
<p>&hellip;&hellip;</p>
</li>
</ul>
</li>
</ol>
<h1 id="2-创建vue3工程">2. 创建Vue3工程</h1>
<h2 id="21-基于-vue-cli-创建">2.1. 【基于 vue-cli 创建】</h2>
<p>点击查看<a href="https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create">官方文档</a></p>
<blockquote>
<p>备注：目前<code>vue-cli</code>已处于维护模式，官方推荐基于 <code>Vite</code> 创建项目。</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c">## 查看@vue/cli版本，确保@vue/cli版本在4.5.0以上</span>
<span class="n">vue</span> <span class="p">-</span><span class="n">-version</span>

<span class="c">## 安装或者升级你的@vue/cli </span>
<span class="n">npm</span> <span class="n">install</span> <span class="n">-g</span> <span class="nv">@vue</span><span class="p">/</span><span class="nb">cli
</span><span class="nb"></span>
<span class="c">## 执行创建命令</span>
<span class="n">vue</span> <span class="n">create</span> <span class="n">vue_test</span>

<span class="c">##  随后选择3.x</span>
<span class="c">##  Choose a version of Vue.js that you want to start the project with (Use arrow keys)</span>
<span class="c">##  &gt; 3.x</span>
<span class="c">##    2.x</span>

<span class="c">## 启动</span>
<span class="nb">cd </span><span class="n">vue_test</span>
<span class="n">npm</span> <span class="n">run</span> <span class="n">serve</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="22-基于-vite-创建推荐">2.2. 【基于 vite 创建】(推荐)</h2>
<p><code>vite</code> 是新一代前端构建工具，官网地址：<a href="https://vitejs.cn/">https://vitejs.cn</a>，<code>vite</code>的优势如下：</p>
<ul>
<li>轻量快速的热重载（<code>HMR</code>），能实现极速的服务启动。</li>
<li>对 <code>TypeScript</code>、<code>JSX</code>、<code>CSS</code> 等支持开箱即用。</li>
<li>真正的按需编译，不再等待整个应用编译完成。</li>
<li><code>webpack</code>构建 与 <code>vite</code>构建对比图如下：
<img src="/images/1683167182037-71c78210-8217-4e7d-9a83-e463035efbbe.png" alt="webpack构建" title="webpack构建">
<img src="/images/1683167204081-582dc237-72bc-499e-9589-2cdfd452e62f.png" alt="vite构建" title="vite构建">
<!-- raw HTML omitted -->	<!-- raw HTML omitted --></li>
</ul>
<ul>
<li>具体操作如下（点击查看<a href="https://cn.vuejs.org/guide/quick-start.html#creating-a-vue-application">官方文档</a>）</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c">## 1.创建命令</span>
<span class="n">npm</span> <span class="n">create</span> <span class="n">vue</span><span class="nv">@latest</span>

<span class="c">## 2.具体配置</span>
<span class="c">## 配置项目名称</span>
<span class="err">√</span> <span class="n">Project</span> <span class="n">name</span><span class="err">:</span> <span class="n">vue3_test</span>
<span class="c">## 是否添加TypeScript支持</span>
<span class="err">√</span> <span class="n">Add</span> <span class="n">TypeScript</span><span class="p">?</span>  <span class="n">Yes</span>
<span class="c">## 是否添加JSX支持</span>
<span class="err">√</span> <span class="n">Add</span> <span class="n">JSX</span> <span class="n">Support</span><span class="p">?</span>  <span class="n">No</span>
<span class="c">## 是否添加路由环境</span>
<span class="err">√</span> <span class="n">Add</span> <span class="n">Vue</span> <span class="n">Router</span> <span class="k">for</span> <span class="n">Single</span> <span class="n">Page</span> <span class="n">Application</span> <span class="n">development</span><span class="p">?</span>  <span class="n">No</span>
<span class="c">## 是否添加pinia环境</span>
<span class="err">√</span> <span class="n">Add</span> <span class="n">Pinia</span> <span class="k">for</span> <span class="n">state</span> <span class="n">management</span><span class="p">?</span>  <span class="n">No</span>
<span class="c">## 是否添加单元测试</span>
<span class="err">√</span> <span class="n">Add</span> <span class="n">Vitest</span> <span class="k">for</span> <span class="n">Unit</span> <span class="n">Testing</span><span class="p">?</span>  <span class="n">No</span>
<span class="c">## 是否添加端到端测试方案</span>
<span class="err">√</span> <span class="n">Add</span> <span class="n">an</span> <span class="k">End</span><span class="n">-to-End</span> <span class="n">Testing</span> <span class="n">Solution</span><span class="p">?</span> <span class="err">»</span> <span class="n">No</span>
<span class="c">## 是否添加ESLint语法检查</span>
<span class="err">√</span> <span class="n">Add</span> <span class="n">ESLint</span> <span class="k">for</span> <span class="n">code</span> <span class="n">quality</span><span class="p">?</span>  <span class="n">Yes</span>
<span class="c">## 是否添加Prettiert代码格式化</span>
<span class="err">√</span> <span class="n">Add</span> <span class="n">Prettier</span> <span class="k">for</span> <span class="n">code</span> <span class="n">formatting</span><span class="p">?</span>  <span class="n">No</span>
</code></pre></td></tr></table>
</div>
</div><p>自己动手编写一个App组件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;app&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">你好啊</span><span class="err">！</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
  <span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;App&#39;</span> <span class="c1">//组件名
</span><span class="c1"></span>  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">.</span><span class="nx">app</span> <span class="p">{</span>
    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">ddd</span><span class="p">;</span>
    <span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">10</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">10</span><span class="nx">px</span><span class="p">;</span>
    <span class="nx">padding</span><span class="o">:</span> <span class="mi">20</span><span class="nx">px</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>安装官方推荐的<code>vscode</code>插件：</p>
<p><img src="/images/volar.png" alt="Snipaste_2023-10-08_20-46-34" title="Snipaste_2023-10-08_20-46-34">
<!-- raw HTML omitted --></p>
<p><img src="/images/image-20231218085906380.png" alt="image-20231218085906380" title="image-20231218085906380">
<!-- raw HTML omitted --></p>
<p>总结：</p>
<ul>
<li><code>Vite</code> 项目中，<code>index.html</code> 是项目的入口文件，在项目最外层。</li>
<li>加载<code>index.html</code>后，<code>Vite</code> 解析 <code>&lt;script type=&quot;module&quot; src=&quot;xxx&quot;&gt;</code> 指向的<code>JavaScript</code>。</li>
<li><code>Vue3</code>**中是通过 **<code>createApp</code> 函数创建一个应用实例。</li>
</ul>
<h2 id="23-一个简单的效果">2.3. 【一个简单的效果】</h2>
<p><code>Vue3</code>向下兼容<code>Vue2</code>语法，且<code>Vue3</code>中的模板中可以没有根标签</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{{</span><span class="nx">name</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{{</span><span class="nx">age</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeName&#34;</span><span class="p">&gt;</span><span class="na">修改名字</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeAge&#34;</span><span class="p">&gt;</span><span class="na">年龄</span><span class="err">+</span><span class="na">1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;showTel&#34;</span><span class="p">&gt;</span><span class="na">点我查看联系方式</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
  <span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;App&#39;</span><span class="p">,</span>
    <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span>
        <span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span>
        <span class="nx">tel</span><span class="o">:</span><span class="s1">&#39;13888888888&#39;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">methods</span><span class="o">:</span><span class="p">{</span>
      <span class="nx">changeName</span><span class="p">(){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;zhang-san&#39;</span>
      <span class="p">},</span>
      <span class="nx">changeAge</span><span class="p">(){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">+=</span> <span class="mi">1</span>
      <span class="p">},</span>
      <span class="nx">showTel</span><span class="p">(){</span>
        <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tel</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">},</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="3-vue3核心语法">3. Vue3核心语法</h1>
<h2 id="31--optionsapi-与-compositionapi">3.1.  【OptionsAPI 与 CompositionAPI】</h2>
<ul>
<li><code>Vue2</code>的<code>API</code>设计是<code>Options</code>（配置）风格的。</li>
<li><code>Vue3</code>的<code>API</code>设计是<code>Composition</code>（组合）风格的。</li>
</ul>
<h3 id="options-api-的弊端">Options API 的弊端</h3>
<p><code>Options</code>类型的 <code>API</code>，数据、方法、计算属性等，是分散在：<code>data</code>、<code>methods</code>、<code>computed</code>中的，若想新增或者修改一个需求，就需要分别修改：<code>data</code>、<code>methods</code>、<code>computed</code>，不便于维护和复用。</p>
<p><img src="/images/1696662197101-55d2b251-f6e5-47f4-b3f1-d8531bbf9279.gif" alt="1.gif" title="1.gif">
<img src="/images/1696662200734-1bad8249-d7a2-423e-a3c3-ab4c110628be.gif" alt="2.gif" title="2.gif">
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h3 id="composition-api-的优势">Composition API 的优势</h3>
<p>可以用函数的方式，更加优雅的组织代码，让相关功能的代码更加有序的组织在一起。</p>
<p><img src="/images/1696662249851-db6403a1-acb5-481a-88e0-e1e34d2ef53a.gif" alt="3.gif" title="3.gif">
<img src="/images/1696662256560-7239b9f9-a770-43c1-9386-6cc12ef1e9c0.gif" alt="4.gif" title="4.gif">
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<blockquote>
<p>说明：以上四张动图原创作者：大帅老猿</p>
</blockquote>
<h2 id="32-拉开序幕的-setup">3.2. 【拉开序幕的 setup】</h2>
<h3 id="setup-概述">setup 概述</h3>
<p><code>setup</code>是<code>Vue3</code>中一个新的配置项，值是一个函数，它是 <code>Composition API</code> <strong>“表演的舞台</strong><em><strong>”</strong></em>，组件中所用到的：数据、方法、计算属性、监视&hellip;&hellip;等等，均配置在<code>setup</code>中。</p>
<p>特点如下：</p>
<ul>
<li><code>setup</code>函数返回的对象中的内容，可直接在模板中使用。</li>
<li><code>setup</code>中访问<code>this</code>是<code>undefined</code>。</li>
<li><code>setup</code>函数会在<code>beforeCreate</code>之前调用，它是“领先”所有钩子执行的。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{{</span><span class="nx">name</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{{</span><span class="nx">age</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeName&#34;</span><span class="p">&gt;</span><span class="na">修改名字</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeAge&#34;</span><span class="p">&gt;</span><span class="na">年龄</span><span class="err">+</span><span class="na">1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;showTel&#34;</span><span class="p">&gt;</span><span class="na">点我查看联系方式</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
  <span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;Person&#39;</span><span class="p">,</span>
    <span class="nx">setup</span><span class="p">(){</span>
      <span class="c1">// 数据，原来写在data中（注意：此时的name、age、tel数据都不是响应式数据）
</span><span class="c1"></span>      <span class="kd">let</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;张三&#39;</span>
      <span class="kd">let</span> <span class="nx">age</span> <span class="o">=</span> <span class="mi">18</span>
      <span class="kd">let</span> <span class="nx">tel</span> <span class="o">=</span> <span class="s1">&#39;13888888888&#39;</span>

      <span class="c1">// 方法，原来写在methods中
</span><span class="c1"></span>      <span class="kd">function</span> <span class="nx">changeName</span><span class="p">(){</span>
        <span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;zhang-san&#39;</span> <span class="c1">//注意：此时这么修改name页面是不变化的
</span><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="kd">function</span> <span class="nx">changeAge</span><span class="p">(){</span>
        <span class="nx">age</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1">//注意：此时这么修改age页面是不变化的
</span><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">age</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="kd">function</span> <span class="nx">showTel</span><span class="p">(){</span>
        <span class="nx">alert</span><span class="p">(</span><span class="nx">tel</span><span class="p">)</span>
      <span class="p">}</span>

      <span class="c1">// 返回一个对象，对象中的内容，模板中可以直接使用
</span><span class="c1"></span>      <span class="k">return</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">,</span><span class="nx">tel</span><span class="p">,</span><span class="nx">changeName</span><span class="p">,</span><span class="nx">changeAge</span><span class="p">,</span><span class="nx">showTel</span><span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="setup-的返回值">setup 的返回值</h3>
<ul>
<li>若返回一个<strong>对象</strong>：则对象中的：属性、方法等，在模板中均可以直接使用**（重点关注）。**</li>
<li>若返回一个<strong>函数</strong>：则可以自定义渲染内容，代码如下：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-jsx" data-lang="jsx"><span class="nx">setup</span><span class="p">(){</span>
  <span class="k">return</span> <span class="p">()=&gt;</span> <span class="s1">&#39;你好啊！&#39;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="setup-与-options-api-的关系">setup 与 Options API 的关系</h3>
<ul>
<li><code>Vue2</code> 的配置（<code>data</code>、<code>methos</code>&hellip;&hellip;）中<strong>可以访问到</strong> <code>setup</code>中的属性、方法。</li>
<li>但在<code>setup</code>中<strong>不能访问到</strong><code>Vue2</code>的配置（<code>data</code>、<code>methos</code>&hellip;&hellip;）。</li>
<li>如果与<code>Vue2</code>冲突，则<code>setup</code>优先。</li>
</ul>
<h3 id="setup-语法糖">setup 语法糖</h3>
<p><code>setup</code>函数有一个语法糖，这个语法糖，可以让我们把<code>setup</code>独立出去，代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{{</span><span class="nx">name</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{{</span><span class="nx">age</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changName&#34;</span><span class="p">&gt;</span><span class="na">修改名字</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changAge&#34;</span><span class="p">&gt;</span><span class="na">年龄</span><span class="err">+</span><span class="na">1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;showTel&#34;</span><span class="p">&gt;</span><span class="na">点我查看联系方式</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
  <span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;Person&#39;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="c">&lt;!--</span> <span class="nx">下面的写法是setup语法糖</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span><span class="p">&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="c1">//undefined
</span><span class="c1"></span>  
  <span class="c1">// 数据（注意：此时的name、age、tel都不是响应式数据）
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;张三&#39;</span>
  <span class="kd">let</span> <span class="nx">age</span> <span class="o">=</span> <span class="mi">18</span>
  <span class="kd">let</span> <span class="nx">tel</span> <span class="o">=</span> <span class="s1">&#39;13888888888&#39;</span>

  <span class="c1">// 方法
</span><span class="c1"></span>  <span class="kd">function</span> <span class="nx">changName</span><span class="p">(){</span>
    <span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;李四&#39;</span><span class="c1">//注意：此时这么修改name页面是不变化的
</span><span class="c1"></span>  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changAge</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">age</span><span class="p">)</span>
    <span class="nx">age</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1">//注意：此时这么修改age页面是不变化的
</span><span class="c1"></span>  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">showTel</span><span class="p">(){</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">tel</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>扩展：上述代码，还需要编写一个不写<code>setup</code>的<code>script</code>标签，去指定组件名字，比较麻烦，我们可以借助<code>vite</code>中的插件简化</p>
<ol>
<li>第一步：<code>npm i vite-plugin-vue-setup-extend -D</code></li>
<li>第二步：<code>vite.config.ts</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-jsx" data-lang="jsx"><span class="kr">import</span> <span class="p">{</span> <span class="nx">defineConfig</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vite&#39;</span>
<span class="kr">import</span> <span class="nx">VueSetupExtend</span> <span class="nx">from</span> <span class="s1">&#39;vite-plugin-vue-setup-extend&#39;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">defineConfig</span><span class="p">({</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span> <span class="nx">VueSetupExtend</span><span class="p">()</span> <span class="p">]</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>第三步：<code>&lt;script setup lang=&quot;ts&quot; name=&quot;Person&quot;&gt;</code></li>
</ol>
<h2 id="33-ref-创建基本类型的响应式数据">3.3. 【ref 创建：基本类型的响应式数据】</h2>
<ul>
<li>**作用：**定义响应式变量。</li>
<li>**语法：**<code>let xxx = ref(初始值)</code>。</li>
<li><strong>返回值：<strong>一个<code>RefImpl</code>的实例对象，简称<code>ref对象</code>或<code>ref</code>，<code>ref</code>对象的<code>value</code></strong>属性是响应式的</strong>。</li>
<li><strong>注意点：</strong>
<ul>
<li><code>JS</code>中操作数据需要：<code>xxx.value</code>，但模板中不需要<code>.value</code>，直接使用即可。</li>
<li>对于<code>let name = ref('张三')</code>来说，<code>name</code>不是响应式的，<code>name.value</code>是响应式的。</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{{</span><span class="nx">name</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{{</span><span class="nx">age</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeName&#34;</span><span class="p">&gt;</span><span class="na">修改名字</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeAge&#34;</span><span class="p">&gt;</span><span class="na">年龄</span><span class="err">+</span><span class="na">1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;showTel&#34;</span><span class="p">&gt;</span><span class="na">点我查看联系方式</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
  <span class="c1">// name和age是一个RefImpl的实例对象，简称ref对象，它们的value属性是响应式的。
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="s1">&#39;张三&#39;</span><span class="p">)</span>
  <span class="kd">let</span> <span class="nx">age</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
  <span class="c1">// tel就是一个普通的字符串，不是响应式的
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">tel</span> <span class="o">=</span> <span class="s1">&#39;13888888888&#39;</span>

  <span class="kd">function</span> <span class="nx">changeName</span><span class="p">(){</span>
    <span class="c1">// JS中操作ref对象时候需要.value
</span><span class="c1"></span>    <span class="nx">name</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;李四&#39;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">name</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>

    <span class="c1">// 注意：name不是响应式的，name.value是响应式的，所以如下代码并不会引起页面的更新。
</span><span class="c1"></span>    <span class="c1">// name = ref(&#39;zhang-san&#39;)
</span><span class="c1"></span>  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeAge</span><span class="p">(){</span>
    <span class="c1">// JS中操作ref对象时候需要.value
</span><span class="c1"></span>    <span class="nx">age</span><span class="p">.</span><span class="nx">value</span> <span class="o">+=</span> <span class="mi">1</span> 
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">age</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">showTel</span><span class="p">(){</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">tel</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="34-reactive-创建对象类型的响应式数据">3.4. 【reactive 创建：对象类型的响应式数据】</h2>
<ul>
<li><strong>作用：<strong>定义一个</strong>响应式对象</strong>（基本类型不要用它，要用<code>ref</code>，否则报错）</li>
<li>**语法：**<code>let 响应式对象= reactive(源对象)</code>。</li>
<li>**返回值：**一个<code>Proxy</code>的实例对象，简称：响应式对象。</li>
<li>**注意点：**<code>reactive</code>定义的响应式数据是“深层次”的。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">汽车信息</span><span class="err">：</span><span class="nx">一台</span><span class="p">{{</span> <span class="nx">car</span><span class="p">.</span><span class="nx">brand</span> <span class="p">}}</span><span class="nx">汽车</span><span class="err">，</span><span class="nx">价值</span><span class="p">{{</span> <span class="nx">car</span><span class="p">.</span><span class="nx">price</span> <span class="p">}}</span><span class="nx">万</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">游戏列表</span><span class="err">：</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;g in games&#34; :key=&#34;g.id&#34;&gt;{{ g.name }}&lt;/li&gt;
</span><span class="s">    &lt;/ul&gt;
</span><span class="s">    &lt;h2&gt;测试：{{obj.a.b.c.d}}&lt;/h2&gt;
</span><span class="s">    &lt;button @click=&#34;changeCarPrice&#34;&gt;修改汽车价格&lt;/button&gt;
</span><span class="s">    &lt;button @click=&#34;changeFirstGame&#34;&gt;修改第一游戏&lt;/button&gt;
</span><span class="s">    &lt;button @click=&#34;test&#34;&gt;测试&lt;/button&gt;
</span><span class="s">  &lt;/div&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">
</span><span class="s">&lt;script lang=&#34;ts&#34; setup name=&#34;Person&#34;</span><span class="p">&gt;</span>
<span class="na">import</span> <span class="p">{</span> <span class="na">reactive</span> <span class="p">}</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="err">&#39;</span>

<span class="err">//</span> <span class="na">数据</span>
<span class="na">let</span> <span class="na">car </span><span class="o">=</span> <span class="na">reactive</span><span class="err">(</span><span class="p">{</span> <span class="na">brand</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">奔驰</span><span class="err">&#39;,</span> <span class="na">price</span><span class="o">:</span> <span class="na">100</span> <span class="p">}</span><span class="err">)</span>
<span class="na">let</span> <span class="na">games </span><span class="o">=</span> <span class="na">reactive</span><span class="err">([</span>
  <span class="p">{</span> <span class="na">id</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">ahsgdyfa01</span><span class="err">&#39;,</span> <span class="na">name</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">英雄联盟</span><span class="err">&#39;</span> <span class="p">}</span><span class="err">,</span>
  <span class="p">{</span> <span class="na">id</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">ahsgdyfa02</span><span class="err">&#39;,</span> <span class="na">name</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">王者荣耀</span><span class="err">&#39;</span> <span class="p">}</span><span class="err">,</span>
  <span class="p">{</span> <span class="na">id</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">ahsgdyfa03</span><span class="err">&#39;,</span> <span class="na">name</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">原神</span><span class="err">&#39;</span> <span class="p">}</span>
<span class="err">])</span>
<span class="na">let</span> <span class="na">obj </span><span class="o">=</span> <span class="na">reactive</span><span class="err">(</span><span class="p">{</span>
  <span class="na">a</span><span class="o">:</span><span class="p">{</span>
    <span class="na">b</span><span class="o">:</span><span class="p">{</span>
      <span class="na">c</span><span class="o">:</span><span class="p">{</span>
        <span class="na">d</span><span class="o">:</span><span class="na">666</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span><span class="err">)</span>

<span class="na">function</span> <span class="na">changeCarPrice</span><span class="err">()</span> <span class="p">{</span>
  <span class="na">car.price</span> <span class="err">+=</span> <span class="na">10</span>
<span class="p">}</span>
<span class="na">function</span> <span class="na">changeFirstGame</span><span class="err">()</span> <span class="p">{</span>
  <span class="na">games</span><span class="err">[</span><span class="na">0</span><span class="err">]</span><span class="na">.name</span> <span class="err">=</span> <span class="err">&#39;</span><span class="na">流星蝴蝶剑</span><span class="err">&#39;</span>
<span class="p">}</span>
<span class="na">function</span> <span class="na">test</span><span class="err">()</span><span class="p">{</span>
  <span class="na">obj.a.b.c.d</span> <span class="err">=</span> <span class="na">999</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="35-ref-创建对象类型的响应式数据">3.5. 【ref 创建：对象类型的响应式数据】</h2>
<ul>
<li>其实<code>ref</code>接收的数据可以是：<strong>基本类型</strong>、<strong>对象类型</strong>。</li>
<li>若<code>ref</code>接收的是对象类型，内部其实也是调用了<code>reactive</code>函数。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">汽车信息</span><span class="err">：</span><span class="nx">一台</span><span class="p">{{</span> <span class="nx">car</span><span class="p">.</span><span class="nx">brand</span> <span class="p">}}</span><span class="nx">汽车</span><span class="err">，</span><span class="nx">价值</span><span class="p">{{</span> <span class="nx">car</span><span class="p">.</span><span class="nx">price</span> <span class="p">}}</span><span class="nx">万</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">游戏列表</span><span class="err">：</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;g in games&#34; :key=&#34;g.id&#34;&gt;{{ g.name }}&lt;/li&gt;
</span><span class="s">    &lt;/ul&gt;
</span><span class="s">    &lt;h2&gt;测试：{{obj.a.b.c.d}}&lt;/h2&gt;
</span><span class="s">    &lt;button @click=&#34;changeCarPrice&#34;&gt;修改汽车价格&lt;/button&gt;
</span><span class="s">    &lt;button @click=&#34;changeFirstGame&#34;&gt;修改第一游戏&lt;/button&gt;
</span><span class="s">    &lt;button @click=&#34;test&#34;&gt;测试&lt;/button&gt;
</span><span class="s">  &lt;/div&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">
</span><span class="s">&lt;script lang=&#34;ts&#34; setup name=&#34;Person&#34;</span><span class="p">&gt;</span>
<span class="na">import</span> <span class="p">{</span> <span class="na">ref</span> <span class="p">}</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="err">&#39;</span>

<span class="err">//</span> <span class="na">数据</span>
<span class="na">let</span> <span class="na">car </span><span class="o">=</span> <span class="na">ref</span><span class="err">(</span><span class="p">{</span> <span class="na">brand</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">奔驰</span><span class="err">&#39;,</span> <span class="na">price</span><span class="o">:</span> <span class="na">100</span> <span class="p">}</span><span class="err">)</span>
<span class="na">let</span> <span class="na">games </span><span class="o">=</span> <span class="na">ref</span><span class="err">([</span>
  <span class="p">{</span> <span class="na">id</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">ahsgdyfa01</span><span class="err">&#39;,</span> <span class="na">name</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">英雄联盟</span><span class="err">&#39;</span> <span class="p">}</span><span class="err">,</span>
  <span class="p">{</span> <span class="na">id</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">ahsgdyfa02</span><span class="err">&#39;,</span> <span class="na">name</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">王者荣耀</span><span class="err">&#39;</span> <span class="p">}</span><span class="err">,</span>
  <span class="p">{</span> <span class="na">id</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">ahsgdyfa03</span><span class="err">&#39;,</span> <span class="na">name</span><span class="o">:</span> <span class="err">&#39;</span><span class="na">原神</span><span class="err">&#39;</span> <span class="p">}</span>
<span class="err">])</span>
<span class="na">let</span> <span class="na">obj </span><span class="o">=</span> <span class="na">ref</span><span class="err">(</span><span class="p">{</span>
  <span class="na">a</span><span class="o">:</span><span class="p">{</span>
    <span class="na">b</span><span class="o">:</span><span class="p">{</span>
      <span class="na">c</span><span class="o">:</span><span class="p">{</span>
        <span class="na">d</span><span class="o">:</span><span class="na">666</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span><span class="err">)</span>

<span class="na">console.log</span><span class="err">(</span><span class="na">car</span><span class="err">)</span>

<span class="na">function</span> <span class="na">changeCarPrice</span><span class="err">()</span> <span class="p">{</span>
  <span class="na">car.value.price</span> <span class="err">+=</span> <span class="na">10</span>
<span class="p">}</span>
<span class="na">function</span> <span class="na">changeFirstGame</span><span class="err">()</span> <span class="p">{</span>
  <span class="na">games.value</span><span class="err">[</span><span class="na">0</span><span class="err">]</span><span class="na">.name</span> <span class="err">=</span> <span class="err">&#39;</span><span class="na">流星蝴蝶剑</span><span class="err">&#39;</span>
<span class="p">}</span>
<span class="na">function</span> <span class="na">test</span><span class="err">()</span><span class="p">{</span>
  <span class="na">obj.value.a.b.c.d</span> <span class="err">=</span> <span class="na">999</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="36-ref-对比-reactive">3.6. 【ref 对比 reactive】</h2>
<p>宏观角度看：</p>
<blockquote>
<ol>
<li>
<p><code>ref</code>用来定义：<strong>基本类型数据</strong>、<strong>对象类型数据</strong>；</p>
</li>
<li>
<p><code>reactive</code>用来定义：<strong>对象类型数据</strong>。</p>
</li>
</ol>
</blockquote>
<ul>
<li>区别：</li>
</ul>
<blockquote>
<ol>
<li>
<p><code>ref</code>创建的变量必须使用<code>.value</code>（可以使用<code>volar</code>插件自动添加<code>.value</code>）。</p>
<p><!-- raw HTML omitted -->
<img src="/images/%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%85value.png" alt="自动补充value" title="自动补充value"></p>
</li>
<li>
<p><code>reactive</code>重新分配一个新对象，会<strong>失去</strong>响应式（可以使用<code>Object.assign</code>去整体替换）。</p>
</li>
</ol>
</blockquote>
<ul>
<li>使用原则：</li>
</ul>
<blockquote>
<ol>
<li>若需要一个基本类型的响应式数据，必须使用<code>ref</code>。</li>
<li>若需要一个响应式对象，层级不深，<code>ref</code>、<code>reactive</code>都可以。</li>
<li>若需要一个响应式对象，且层级较深，推荐使用<code>reactive</code>。</li>
</ol>
</blockquote>
<h2 id="37-torefs-与-toref">3.7. 【toRefs 与 toRef】</h2>
<ul>
<li>作用：将一个响应式对象中的每一个属性，转换为<code>ref</code>对象。</li>
<li>备注：<code>toRefs</code>与<code>toRef</code>功能一致，但<code>toRefs</code>可以批量转换。</li>
<li>语法如下：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{{</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{{</span><span class="nx">person</span><span class="p">.</span><span class="nx">age</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">性别</span><span class="err">：</span><span class="p">{{</span><span class="nx">person</span><span class="p">.</span><span class="nx">gender</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeName&#34;</span><span class="p">&gt;</span><span class="na">修改名字</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeAge&#34;</span><span class="p">&gt;</span><span class="na">修改年龄</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeGender&#34;</span><span class="p">&gt;</span><span class="na">修改性别</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">,</span><span class="nx">reactive</span><span class="p">,</span><span class="nx">toRefs</span><span class="p">,</span><span class="nx">toRef</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>

  <span class="c1">// 数据
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">person</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span> <span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span> <span class="nx">gender</span><span class="o">:</span><span class="s1">&#39;男&#39;</span><span class="p">})</span>
	
  <span class="c1">// 通过toRefs将person对象中的n个属性批量取出，且依然保持响应式的能力
</span><span class="c1"></span>  <span class="kd">let</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="nx">gender</span><span class="p">}</span> <span class="o">=</span>  <span class="nx">toRefs</span><span class="p">(</span><span class="nx">person</span><span class="p">)</span>
	
  <span class="c1">// 通过toRef将person对象中的gender属性取出，且依然保持响应式的能力
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">age</span> <span class="o">=</span> <span class="nx">toRef</span><span class="p">(</span><span class="nx">person</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">)</span>

  <span class="c1">// 方法
</span><span class="c1"></span>  <span class="kd">function</span> <span class="nx">changeName</span><span class="p">(){</span>
    <span class="nx">name</span><span class="p">.</span><span class="nx">value</span> <span class="o">+=</span> <span class="s1">&#39;~&#39;</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeAge</span><span class="p">(){</span>
    <span class="nx">age</span><span class="p">.</span><span class="nx">value</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeGender</span><span class="p">(){</span>
    <span class="nx">gender</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;女&#39;</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="38-computed">3.8. 【computed】</h2>
<p>作用：根据已有数据计算出新数据（和<code>Vue2</code>中的<code>computed</code>作用一致）。</p>
<p><img src="/images/computed.gif" alt="computed.gif" title="computed.gif">
<!-- raw HTML omitted --></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="nx">姓</span><span class="err">：</span><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="nt">v-model</span><span class="s">=&#34;firstName&#34;</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    <span class="nx">名</span><span class="err">：</span><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="nt">v-model</span><span class="s">=&#34;lastName&#34;</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    <span class="nx">全名</span><span class="err">：</span><span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;{{</span><span class="nx">fullName</span><span class="p">}}&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeFullName&#34;</span><span class="p">&gt;</span><span class="na">全名改为</span><span class="err">：</span><span class="na">li</span><span class="nt">-si</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;App&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">,</span><span class="nx">computed</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>

  <span class="kd">let</span> <span class="nx">firstName</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="s1">&#39;zhang&#39;</span><span class="p">)</span>
  <span class="kd">let</span> <span class="nx">lastName</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="s1">&#39;san&#39;</span><span class="p">)</span>

  <span class="c1">// 计算属性——只读取，不修改
</span><span class="c1"></span>  <span class="cm">/* let fullName = computed(()=&gt;{
</span><span class="cm">    return firstName.value + &#39;-&#39; + lastName.value
</span><span class="cm">  }) */</span>


  <span class="c1">// 计算属性——既读取又修改
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">fullName</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">({</span>
    <span class="c1">// 读取
</span><span class="c1"></span>    <span class="nx">get</span><span class="p">(){</span>
      <span class="k">return</span> <span class="nx">firstName</span><span class="p">.</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nx">lastName</span><span class="p">.</span><span class="nx">value</span>
    <span class="p">},</span>
    <span class="c1">// 修改
</span><span class="c1"></span>    <span class="nx">set</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;有人修改了fullName&#39;</span><span class="p">,</span><span class="nx">val</span><span class="p">)</span>
      <span class="nx">firstName</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">val</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
      <span class="nx">lastName</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">val</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">})</span>

  <span class="kd">function</span> <span class="nx">changeFullName</span><span class="p">(){</span>
    <span class="nx">fullName</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;li-si&#39;</span>
  <span class="p">}</span> 
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="39watch">3.9.【watch】</h2>
<ul>
<li>作用：监视数据的变化（和<code>Vue2</code>中的<code>watch</code>作用一致）</li>
<li>特点：<code>Vue3</code>中的<code>watch</code>只能监视以下<strong>四种数据</strong>：</li>
</ul>
<blockquote>
<ol>
<li><code>ref</code>定义的数据。</li>
<li><code>reactive</code>定义的数据。</li>
<li>函数返回一个值（<code>getter</code>函数）。</li>
<li>一个包含上述内容的数组。</li>
</ol>
</blockquote>
<p>我们在<code>Vue3</code>中使用<code>watch</code>的时候，通常会遇到以下几种情况：</p>
<h3 id="-情况一">* 情况一</h3>
<p>监视<code>ref</code>定义的【基本类型】数据：直接写数据名即可，监视的是其<code>value</code>值的改变。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">情况一</span><span class="err">：</span><span class="nx">监视</span><span class="err">【</span><span class="nx">ref</span><span class="err">】</span><span class="nx">定义的</span><span class="err">【</span><span class="nx">基本类型</span><span class="err">】</span><span class="nx">数据</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{{</span><span class="nx">sum</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeSum&#34;</span><span class="p">&gt;</span><span class="na">点我sum</span><span class="err">+</span><span class="na">1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">,</span><span class="nx">watch</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
  <span class="c1">// 数据
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="c1">// 方法
</span><span class="c1"></span>  <span class="kd">function</span> <span class="nx">changeSum</span><span class="p">(){</span>
    <span class="nx">sum</span><span class="p">.</span><span class="nx">value</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">}</span>
  <span class="c1">// 监视，情况一：监视【ref】定义的【基本类型】数据
</span><span class="c1"></span>  <span class="kr">const</span> <span class="nx">stopWatch</span> <span class="o">=</span> <span class="nx">watch</span><span class="p">(</span><span class="nx">sum</span><span class="p">,(</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;sum变化了&#39;</span><span class="p">,</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">newValue</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">){</span>
      <span class="nx">stopWatch</span><span class="p">()</span>
    <span class="p">}</span>
  <span class="p">})</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="-情况二">* 情况二</h3>
<p>监视<code>ref</code>定义的【对象类型】数据：直接写数据名，监视的是对象的【地址值】，若想监视对象内部的数据，要手动开启深度监视。</p>
<blockquote>
<p>注意：</p>
<ul>
<li>
<p>若修改的是<code>ref</code>定义的对象中的属性，<code>newValue</code> 和 <code>oldValue</code> 都是新值，因为它们是同一个对象。</p>
</li>
<li>
<p>若修改整个<code>ref</code>定义的对象，<code>newValue</code> 是新值， <code>oldValue</code> 是旧值，因为不是同一个对象了。</p>
</li>
</ul>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">情况二</span><span class="err">：</span><span class="nx">监视</span><span class="err">【</span><span class="nx">ref</span><span class="err">】</span><span class="nx">定义的</span><span class="err">【</span><span class="nx">对象类型</span><span class="err">】</span><span class="nx">数据</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">age</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeName&#34;</span><span class="p">&gt;</span><span class="na">修改名字</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeAge&#34;</span><span class="p">&gt;</span><span class="na">修改年龄</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changePerson&#34;</span><span class="p">&gt;</span><span class="na">修改整个人</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">,</span><span class="nx">watch</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
  <span class="c1">// 数据
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">person</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span>
    <span class="nx">age</span><span class="o">:</span><span class="mi">18</span>
  <span class="p">})</span>
  <span class="c1">// 方法
</span><span class="c1"></span>  <span class="kd">function</span> <span class="nx">changeName</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">name</span> <span class="o">+=</span> <span class="s1">&#39;~&#39;</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeAge</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">age</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changePerson</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;李四&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">90</span><span class="p">}</span>
  <span class="p">}</span>
  <span class="cm">/* 
</span><span class="cm">    监视，情况一：监视【ref】定义的【对象类型】数据，监视的是对象的地址值，若想监视对象内部属性的变化，需要手动开启深度监视
</span><span class="cm">    watch的第一个参数是：被监视的数据
</span><span class="cm">    watch的第二个参数是：监视的回调
</span><span class="cm">    watch的第三个参数是：配置对象（deep、immediate等等.....） 
</span><span class="cm">  */</span>
  <span class="nx">watch</span><span class="p">(</span><span class="nx">person</span><span class="p">,(</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;person变化了&#39;</span><span class="p">,</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)</span>
  <span class="p">},{</span><span class="nx">deep</span><span class="o">:</span><span class="kc">true</span><span class="p">})</span>
  
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="--情况三">*  情况三</h3>
<p>监视<code>reactive</code>定义的【对象类型】数据，且默认开启了深度监视。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">情况三</span><span class="err">：</span><span class="nx">监视</span><span class="err">【</span><span class="nx">reactive</span><span class="err">】</span><span class="nx">定义的</span><span class="err">【</span><span class="nx">对象类型</span><span class="err">】</span><span class="nx">数据</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">age</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeName&#34;</span><span class="p">&gt;</span><span class="na">修改名字</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeAge&#34;</span><span class="p">&gt;</span><span class="na">修改年龄</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changePerson&#34;</span><span class="p">&gt;</span><span class="na">修改整个人</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">测试</span><span class="err">：</span><span class="p">{{</span><span class="nx">obj</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">c</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;test&#34;</span><span class="p">&gt;</span><span class="na">修改obj.a.b.c</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">reactive</span><span class="p">,</span><span class="nx">watch</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
  <span class="c1">// 数据
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">person</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span>
    <span class="nx">age</span><span class="o">:</span><span class="mi">18</span>
  <span class="p">})</span>
  <span class="kd">let</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span>
    <span class="nx">a</span><span class="o">:</span><span class="p">{</span>
      <span class="nx">b</span><span class="o">:</span><span class="p">{</span>
        <span class="nx">c</span><span class="o">:</span><span class="mi">666</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="c1">// 方法
</span><span class="c1"></span>  <span class="kd">function</span> <span class="nx">changeName</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="o">+=</span> <span class="s1">&#39;~&#39;</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeAge</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">age</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changePerson</span><span class="p">(){</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">person</span><span class="p">,{</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;李四&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">80</span><span class="p">})</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">test</span><span class="p">(){</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">c</span> <span class="o">=</span> <span class="mi">888</span>
  <span class="p">}</span>

  <span class="c1">// 监视，情况三：监视【reactive】定义的【对象类型】数据，且默认是开启深度监视的
</span><span class="c1"></span>  <span class="nx">watch</span><span class="p">(</span><span class="nx">person</span><span class="p">,(</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;person变化了&#39;</span><span class="p">,</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="nx">watch</span><span class="p">(</span><span class="nx">obj</span><span class="p">,(</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Obj变化了&#39;</span><span class="p">,</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="-情况四">* 情况四</h3>
<p>监视<code>ref</code>或<code>reactive</code>定义的【对象类型】数据中的<strong>某个属性</strong>，注意点如下：</p>
<ol>
<li>若该属性值<strong>不是</strong>【对象类型】，需要写成函数形式。</li>
<li>若该属性值是<strong>依然</strong>是【对象类型】，可直接编，也可写成函数，建议写成函数。</li>
</ol>
<p>结论：监视的要是对象里的属性，那么最好写函数式，注意点：若是对象监视的是地址值，需要关注对象内部，需要手动开启深度监视。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">情况四</span><span class="err">：</span><span class="nx">监视</span><span class="err">【</span><span class="nx">ref</span><span class="err">】</span><span class="nx">或</span><span class="err">【</span><span class="nx">reactive</span><span class="err">】</span><span class="nx">定义的</span><span class="err">【</span><span class="nx">对象类型</span><span class="err">】</span><span class="nx">数据中的某个属性</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">age</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">汽车</span><span class="err">：</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">car</span><span class="p">.</span><span class="nx">c1</span> <span class="p">}}</span><span class="err">、</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">car</span><span class="p">.</span><span class="nx">c2</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeName&#34;</span><span class="p">&gt;</span><span class="na">修改名字</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeAge&#34;</span><span class="p">&gt;</span><span class="na">修改年龄</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeC1&#34;</span><span class="p">&gt;</span><span class="na">修改第一台车</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeC2&#34;</span><span class="p">&gt;</span><span class="na">修改第二台车</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeCar&#34;</span><span class="p">&gt;</span><span class="na">修改整个车</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">reactive</span><span class="p">,</span><span class="nx">watch</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>

  <span class="c1">// 数据
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">person</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span>
    <span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span>
    <span class="nx">car</span><span class="o">:</span><span class="p">{</span>
      <span class="nx">c1</span><span class="o">:</span><span class="s1">&#39;奔驰&#39;</span><span class="p">,</span>
      <span class="nx">c2</span><span class="o">:</span><span class="s1">&#39;宝马&#39;</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="c1">// 方法
</span><span class="c1"></span>  <span class="kd">function</span> <span class="nx">changeName</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="o">+=</span> <span class="s1">&#39;~&#39;</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeAge</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">age</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeC1</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">car</span><span class="p">.</span><span class="nx">c1</span> <span class="o">=</span> <span class="s1">&#39;奥迪&#39;</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeC2</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">car</span><span class="p">.</span><span class="nx">c2</span> <span class="o">=</span> <span class="s1">&#39;大众&#39;</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeCar</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">car</span> <span class="o">=</span> <span class="p">{</span><span class="nx">c1</span><span class="o">:</span><span class="s1">&#39;雅迪&#39;</span><span class="p">,</span><span class="nx">c2</span><span class="o">:</span><span class="s1">&#39;爱玛&#39;</span><span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// 监视，情况四：监视响应式对象中的某个属性，且该属性是基本类型的，要写成函数式
</span><span class="c1"></span>  <span class="cm">/* watch(()=&gt; person.name,(newValue,oldValue)=&gt;{
</span><span class="cm">    console.log(&#39;person.name变化了&#39;,newValue,oldValue)
</span><span class="cm">  }) */</span>

  <span class="c1">// 监视，情况四：监视响应式对象中的某个属性，且该属性是对象类型的，可以直接写，也能写函数，更推荐写函数
</span><span class="c1"></span>  <span class="nx">watch</span><span class="p">(()=&gt;</span><span class="nx">person</span><span class="p">.</span><span class="nx">car</span><span class="p">,(</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;person.car变化了&#39;</span><span class="p">,</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)</span>
  <span class="p">},{</span><span class="nx">deep</span><span class="o">:</span><span class="kc">true</span><span class="p">})</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="-情况五">* 情况五</h3>
<p>监视上述的多个数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">情况五</span><span class="err">：</span><span class="nx">监视上述的多个数据</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">姓名</span><span class="err">：</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">年龄</span><span class="err">：</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">age</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">汽车</span><span class="err">：</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">car</span><span class="p">.</span><span class="nx">c1</span> <span class="p">}}</span><span class="err">、</span><span class="p">{{</span> <span class="nx">person</span><span class="p">.</span><span class="nx">car</span><span class="p">.</span><span class="nx">c2</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeName&#34;</span><span class="p">&gt;</span><span class="na">修改名字</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeAge&#34;</span><span class="p">&gt;</span><span class="na">修改年龄</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeC1&#34;</span><span class="p">&gt;</span><span class="na">修改第一台车</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeC2&#34;</span><span class="p">&gt;</span><span class="na">修改第二台车</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeCar&#34;</span><span class="p">&gt;</span><span class="na">修改整个车</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">reactive</span><span class="p">,</span><span class="nx">watch</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>

  <span class="c1">// 数据
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">person</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span>
    <span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">,</span>
    <span class="nx">car</span><span class="o">:</span><span class="p">{</span>
      <span class="nx">c1</span><span class="o">:</span><span class="s1">&#39;奔驰&#39;</span><span class="p">,</span>
      <span class="nx">c2</span><span class="o">:</span><span class="s1">&#39;宝马&#39;</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="c1">// 方法
</span><span class="c1"></span>  <span class="kd">function</span> <span class="nx">changeName</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">name</span> <span class="o">+=</span> <span class="s1">&#39;~&#39;</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeAge</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">age</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeC1</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">car</span><span class="p">.</span><span class="nx">c1</span> <span class="o">=</span> <span class="s1">&#39;奥迪&#39;</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeC2</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">car</span><span class="p">.</span><span class="nx">c2</span> <span class="o">=</span> <span class="s1">&#39;大众&#39;</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeCar</span><span class="p">(){</span>
    <span class="nx">person</span><span class="p">.</span><span class="nx">car</span> <span class="o">=</span> <span class="p">{</span><span class="nx">c1</span><span class="o">:</span><span class="s1">&#39;雅迪&#39;</span><span class="p">,</span><span class="nx">c2</span><span class="o">:</span><span class="s1">&#39;爱玛&#39;</span><span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// 监视，情况五：监视上述的多个数据
</span><span class="c1"></span>  <span class="nx">watch</span><span class="p">([()=&gt;</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span><span class="nx">person</span><span class="p">.</span><span class="nx">car</span><span class="p">],(</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;person.car变化了&#39;</span><span class="p">,</span><span class="nx">newValue</span><span class="p">,</span><span class="nx">oldValue</span><span class="p">)</span>
  <span class="p">},{</span><span class="nx">deep</span><span class="o">:</span><span class="kc">true</span><span class="p">})</span>

<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="310-watcheffect">3.10. 【watchEffect】</h2>
<ul>
<li>
<p>官网：立即运行一个函数，同时响应式地追踪其依赖，并在依赖更改时重新执行该函数。</p>
</li>
<li>
<p><code>watch</code>对比<code>watchEffect</code></p>
<blockquote>
<ol>
<li>
<p>都能监听响应式数据的变化，不同的是监听数据变化的方式不同</p>
</li>
<li>
<p><code>watch</code>：要明确指出监视的数据</p>
</li>
<li>
<p><code>watchEffect</code>：不用明确指出监视的数据（函数中用到哪些属性，那就监视哪些属性）。</p>
</li>
</ol>
</blockquote>
</li>
<li>
<p>示例代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">需求</span><span class="err">：</span><span class="nx">水温达到50</span><span class="err">℃，</span><span class="nx">或水位达到20cm</span><span class="err">，</span><span class="nx">则联系服务器</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;demo&#34;</span><span class="p">&gt;</span><span class="nx">水温</span><span class="err">：</span><span class="p">{{</span><span class="nx">temp</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">水位</span><span class="err">：</span><span class="p">{{</span><span class="nx">height</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changePrice&#34;</span><span class="p">&gt;</span><span class="na">水温</span><span class="err">+</span><span class="na">1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeSum&#34;</span><span class="p">&gt;</span><span class="na">水位</span><span class="err">+</span><span class="na">10</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
  
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">,</span><span class="nx">watch</span><span class="p">,</span><span class="nx">watchEffect</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
  <span class="c1">// 数据
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">temp</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="kd">let</span> <span class="nx">height</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  
  <span class="c1">// 方法
</span><span class="c1"></span>  <span class="kd">function</span> <span class="nx">changePrice</span><span class="p">(){</span>
    <span class="nx">temp</span><span class="p">.</span><span class="nx">value</span> <span class="o">+=</span> <span class="mi">10</span>
  <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">changeSum</span><span class="p">(){</span>
    <span class="nx">height</span><span class="p">.</span><span class="nx">value</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">}</span>
  
  <span class="c1">// 用watch实现，需要明确的指出要监视：temp、height
</span><span class="c1"></span>  <span class="nx">watch</span><span class="p">([</span><span class="nx">temp</span><span class="p">,</span><span class="nx">height</span><span class="p">],(</span><span class="nx">value</span><span class="p">)=&gt;{</span>
    <span class="c1">// 从value中获取最新的temp值、height值
</span><span class="c1"></span>    <span class="kr">const</span> <span class="p">[</span><span class="nx">newTemp</span><span class="p">,</span><span class="nx">newHeight</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>
    <span class="c1">// 室温达到50℃，或水位达到20cm，立刻联系服务器
</span><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="nx">newTemp</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="o">||</span> <span class="nx">newHeight</span> <span class="o">&gt;=</span> <span class="mi">20</span><span class="p">){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;联系服务器&#39;</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">})</span>
  
  <span class="c1">// 用watchEffect实现，不用
</span><span class="c1"></span>  <span class="kr">const</span> <span class="nx">stopWtach</span> <span class="o">=</span> <span class="nx">watchEffect</span><span class="p">(()=&gt;{</span>
    <span class="c1">// 室温达到50℃，或水位达到20cm，立刻联系服务器
</span><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="nx">temp</span><span class="p">.</span><span class="nx">value</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="o">||</span> <span class="nx">height</span><span class="p">.</span><span class="nx">value</span> <span class="o">&gt;=</span> <span class="mi">20</span><span class="p">){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;demo&#39;</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="nx">innerText</span><span class="p">)</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;联系服务器&#39;</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="c1">// 水温达到100，或水位达到50，取消监视
</span><span class="c1"></span>    <span class="k">if</span><span class="p">(</span><span class="nx">temp</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="mi">100</span> <span class="o">||</span> <span class="nx">height</span><span class="p">.</span><span class="nx">value</span> <span class="o">===</span> <span class="mi">50</span><span class="p">){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;清理了&#39;</span><span class="p">)</span>
      <span class="nx">stopWtach</span><span class="p">()</span>
    <span class="p">}</span>
  <span class="p">})</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="311-标签的-ref-属性">3.11. 【标签的 ref 属性】</h2>
<p>作用：用于注册模板引用。</p>
<blockquote>
<ul>
<li>
<p>用在普通<code>DOM</code>标签上，获取的是<code>DOM</code>节点。</p>
</li>
<li>
<p>用在组件标签上，获取的是组件实例对象。</p>
</li>
</ul>
</blockquote>
<p>用在普通<code>DOM</code>标签上：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">ref</span><span class="o">=</span><span class="s">&#34;title1&#34;</span><span class="p">&gt;</span><span class="nx">尚硅谷</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">ref</span><span class="o">=</span><span class="s">&#34;title2&#34;</span><span class="p">&gt;</span><span class="nx">前端</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h3</span> <span class="na">ref</span><span class="o">=</span><span class="s">&#34;title3&#34;</span><span class="p">&gt;</span><span class="nx">Vue</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">ref</span><span class="o">=</span><span class="s">&#34;inpt&#34;</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;showLog&#34;</span><span class="p">&gt;</span><span class="na">点我打印内容</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
	
  <span class="kd">let</span> <span class="nx">title1</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">()</span>
  <span class="kd">let</span> <span class="nx">title2</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">()</span>
  <span class="kd">let</span> <span class="nx">title3</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">()</span>

  <span class="kd">function</span> <span class="nx">showLog</span><span class="p">(){</span>
    <span class="c1">// 通过id获取元素
</span><span class="c1"></span>    <span class="kr">const</span> <span class="nx">t1</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;title1&#39;</span><span class="p">)</span>
    <span class="c1">// 打印内容
</span><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="nx">t1</span> <span class="nx">as</span> <span class="nx">HTMLElement</span><span class="p">).</span><span class="nx">innerText</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">((&lt;</span><span class="nt">HTMLElement</span><span class="p">&gt;</span><span class="nx">t1</span><span class="p">).</span><span class="nx">innerText</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">t1</span><span class="o">?</span><span class="p">.</span><span class="nx">innerText</span><span class="p">)</span>
    
		<span class="cm">/************************************/</span>
		
    <span class="c1">// 通过ref获取元素
</span><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">title1</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">title2</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">title3</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>用在组件标签上：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="c">&lt;!--</span> <span class="nx">父组件App</span><span class="p">.</span><span class="nx">vue</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">Person</span> <span class="na">ref</span><span class="o">=</span><span class="s">&#34;ren&#34;</span><span class="p">/&gt;</span>
  <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;test&#34;</span><span class="p">&gt;</span><span class="na">测试</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;App&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="nx">Person</span> <span class="nx">from</span> <span class="s1">&#39;./components/Person.vue&#39;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>

  <span class="kd">let</span> <span class="nx">ren</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">()</span>

  <span class="kd">function</span> <span class="nx">test</span><span class="p">(){</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ren</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ren</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">age</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>


<span class="c">&lt;!--</span> <span class="nx">子组件Person</span><span class="p">.</span><span class="nx">vue中要使用defineExpose暴露内容</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">,</span><span class="nx">defineExpose</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
	<span class="c1">// 数据
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="s1">&#39;张三&#39;</span><span class="p">)</span>
  <span class="kd">let</span> <span class="nx">age</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
  <span class="cm">/****************************/</span>
  <span class="cm">/****************************/</span>
  <span class="c1">// 使用defineExpose将组件中的数据交给外部
</span><span class="c1"></span>  <span class="nx">defineExpose</span><span class="p">({</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">})</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="312-props">3.12. 【props】</h2>
<blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 定义一个接口，限制每个Person对象的格式
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">interface</span> <span class="nx">PersonInter</span> <span class="p">{</span>
 <span class="nx">id</span><span class="o">:</span><span class="nx">string</span><span class="p">,</span>
 <span class="nx">name</span><span class="o">:</span><span class="nx">string</span><span class="p">,</span>
    <span class="nx">age</span><span class="o">:</span><span class="nx">number</span>
   <span class="p">}</span>
   
<span class="c1">// 定义一个自定义类型Persons
</span><span class="c1"></span><span class="kr">export</span> <span class="nx">type</span> <span class="nx">Persons</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nx">PersonInter</span><span class="o">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>App.vue</code>中代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">Person</span> <span class="nt">:list</span><span class="s">=&#34;persons&#34;</span><span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
  
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;App&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="nx">Person</span> <span class="nx">from</span> <span class="s1">&#39;./components/Person.vue&#39;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">reactive</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
    <span class="kr">import</span> <span class="p">{</span><span class="nx">type</span> <span class="nx">Persons</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./types&#39;</span>
  
    <span class="kd">let</span> <span class="nx">persons</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">&lt;</span><span class="nt">Persons</span><span class="p">&gt;([</span>
     <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;e98219e12&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">},</span>
      <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;e98219e13&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;李四&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">19</span><span class="p">},</span>
       <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;e98219e14&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;王五&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">20</span><span class="p">}</span>
     <span class="p">])</span>
   <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  
</code></pre></td></tr></table>
</div>
</div><p><code>Person.vue</code>中代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-Vue" data-lang="Vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;item in list&#34; :key=&#34;item.id&#34;&gt;
</span><span class="s">        {{item.name}}--{{item.age}}
</span><span class="s">      &lt;/li&gt;
</span><span class="s">    &lt;/ul&gt;
</span><span class="s">   &lt;/div&gt;
</span><span class="s">   &lt;/template&gt;
</span><span class="s">  
</span><span class="s">&lt;script lang=&#34;ts&#34; setup name=&#34;Person&#34;</span><span class="p">&gt;</span>
<span class="na">import</span> <span class="p">{</span><span class="na">defineProps</span><span class="p">}</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="err">&#39;</span>
<span class="na">import</span> <span class="p">{</span><span class="na">type</span> <span class="na">PersonInter</span><span class="p">}</span> <span class="na">from</span> <span class="err">&#39;@/</span><span class="na">types</span><span class="err">&#39;</span>
  
  <span class="err">//</span> <span class="na">第一种写法</span><span class="err">：</span><span class="na">仅接收</span>
<span class="err">//</span> <span class="na">const</span> <span class="na">props </span><span class="o">=</span> <span class="na">defineProps</span><span class="err">([&#39;</span><span class="na">list</span><span class="err">&#39;])</span>
  
  <span class="err">//</span> <span class="na">第二种写法</span><span class="err">：</span><span class="na">接收</span><span class="err">+</span><span class="na">限制类型</span>
<span class="err">//</span> <span class="na">defineProps</span><span class="err">&lt;</span><span class="p">{</span><span class="na">list</span><span class="o">:</span><span class="na">Persons</span><span class="p">}&gt;()</span>
  
  <span class="c1">// 第三种写法：接收+限制类型+指定默认值+限制必要性
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">props</span> <span class="o">=</span> <span class="nx">withDefaults</span><span class="p">(</span><span class="nx">defineProps</span><span class="o">&lt;</span><span class="p">{</span><span class="nx">list</span><span class="o">?:</span><span class="nx">Persons</span><span class="p">}</span><span class="o">&gt;</span><span class="p">(),{</span>
     <span class="nx">list</span><span class="o">:</span><span class="p">()=&gt;[{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;asdasg01&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;小猪佩奇&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">}]</span>
  <span class="p">})</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
  <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></blockquote>
<h2 id="313-生命周期">3.13. 【生命周期】</h2>
<ul>
<li>
<p>概念：<code>Vue</code>组件实例在创建时要经历一系列的初始化步骤，在此过程中<code>Vue</code>会在合适的时机，调用特定的函数，从而让开发者有机会在特定阶段运行自己的代码，这些特定的函数统称为：生命周期钩子</p>
</li>
<li>
<p>规律：</p>
<blockquote>
<p>生命周期整体分为四个阶段，分别是：<strong>创建、挂载、更新、销毁</strong>，每个阶段都有两个钩子，一前一后。</p>
</blockquote>
</li>
<li>
<p><code>Vue2</code>的生命周期</p>
<blockquote>
<p>创建阶段：<code>beforeCreate</code>、<code>created</code></p>
<p>挂载阶段：<code>beforeMount</code>、<code>mounted</code></p>
<p>更新阶段：<code>beforeUpdate</code>、<code>updated</code></p>
<p>销毁阶段：<code>beforeDestroy</code>、<code>destroyed</code></p>
</blockquote>
</li>
<li>
<p><code>Vue3</code>的生命周期</p>
<blockquote>
<p>创建阶段：<code>setup</code></p>
<p>挂载阶段：<code>onBeforeMount</code>、<code>onMounted</code></p>
<p>更新阶段：<code>onBeforeUpdate</code>、<code>onUpdated</code></p>
<p>卸载阶段：<code>onBeforeUnmount</code>、<code>onUnmounted</code></p>
</blockquote>
</li>
<li>
<p>常用的钩子：<code>onMounted</code>(挂载完毕)、<code>onUpdated</code>(更新完毕)、<code>onBeforeUnmount</code>(卸载之前)</p>
</li>
<li>
<p>示例代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;person&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{{</span> <span class="nx">sum</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;changeSum&#34;</span><span class="p">&gt;</span><span class="na">点我sum</span><span class="err">+</span><span class="na">1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
  
<span class="err">&lt;!--</span> <span class="na">vue3写法</span> <span class="err">--</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Person&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span> 
    <span class="nx">ref</span><span class="p">,</span> 
    <span class="nx">onBeforeMount</span><span class="p">,</span> 
    <span class="nx">onMounted</span><span class="p">,</span> 
    <span class="nx">onBeforeUpdate</span><span class="p">,</span> 
    <span class="nx">onUpdated</span><span class="p">,</span> 
    <span class="nx">onBeforeUnmount</span><span class="p">,</span> 
    <span class="nx">onUnmounted</span> 
  <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
  
  <span class="c1">// 数据
</span><span class="c1"></span>  <span class="kd">let</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="c1">// 方法
</span><span class="c1"></span>  <span class="kd">function</span> <span class="nx">changeSum</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">sum</span><span class="p">.</span><span class="nx">value</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">}</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;setup&#39;</span><span class="p">)</span>
  <span class="c1">// 生命周期钩子
</span><span class="c1"></span>  <span class="nx">onBeforeMount</span><span class="p">(()=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;挂载之前&#39;</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="nx">onMounted</span><span class="p">(()=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;挂载完毕&#39;</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="nx">onBeforeUpdate</span><span class="p">(()=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;更新之前&#39;</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="nx">onUpdated</span><span class="p">(()=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;更新完毕&#39;</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="nx">onBeforeUnmount</span><span class="p">(()=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;卸载之前&#39;</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="nx">onUnmounted</span><span class="p">(()=&gt;{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;卸载完毕&#39;</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="314-自定义hook">3.14. 【自定义hook】</h2>
<ul>
<li>
<p>什么是<code>hook</code>？—— 本质是一个函数，把<code>setup</code>函数中使用的<code>Composition API</code>进行了封装，类似于<code>vue2.x</code>中的<code>mixin</code>。</p>
</li>
<li>
<p>自定义<code>hook</code>的优势：复用代码, 让<code>setup</code>中的逻辑更清楚易懂。</p>
</li>
</ul>
<p>示例代码：</p>
<ul>
<li>
<p><code>useSum.ts</code>中内容如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span><span class="nx">ref</span><span class="p">,</span><span class="nx">onMounted</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
  
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="kd">let</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  
  <span class="kr">const</span> <span class="nx">increment</span> <span class="o">=</span> <span class="p">()=&gt;{</span>
    <span class="nx">sum</span><span class="p">.</span><span class="nx">value</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="p">}</span>
  <span class="kr">const</span> <span class="nx">decrement</span> <span class="o">=</span> <span class="p">()=&gt;{</span>
    <span class="nx">sum</span><span class="p">.</span><span class="nx">value</span> <span class="o">-=</span> <span class="mi">1</span>
  <span class="p">}</span>
  <span class="nx">onMounted</span><span class="p">(()=&gt;{</span>
    <span class="nx">increment</span><span class="p">()</span>
  <span class="p">})</span>
  
  <span class="c1">//向外部暴露数据
</span><span class="c1"></span>  <span class="k">return</span> <span class="p">{</span><span class="nx">sum</span><span class="p">,</span><span class="nx">increment</span><span class="p">,</span><span class="nx">decrement</span><span class="p">}</span>
<span class="p">}</span>		
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><code>useDog.ts</code>中内容如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span><span class="nx">reactive</span><span class="p">,</span><span class="nx">onMounted</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
<span class="kr">import</span> <span class="nx">axios</span><span class="p">,{</span><span class="nx">AxiosError</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;axios&#39;</span>
  
<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="kd">let</span> <span class="nx">dogList</span> <span class="o">=</span> <span class="nx">reactive</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">([])</span>
  
  <span class="c1">// 方法
</span><span class="c1"></span>  <span class="nx">async</span> <span class="kd">function</span> <span class="nx">getDog</span><span class="p">(){</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="c1">// 发请求
</span><span class="c1"></span>      <span class="kd">let</span> <span class="p">{</span><span class="nx">data</span><span class="p">}</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;https://dog.ceo/api/breed/pembroke/images/random&#39;</span><span class="p">)</span>
      <span class="c1">// 维护数据
</span><span class="c1"></span>      <span class="nx">dogList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// 处理错误
</span><span class="c1"></span>      <span class="kr">const</span> <span class="nx">err</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">AxiosError</span><span class="o">&gt;</span><span class="nx">error</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="c1">// 挂载钩子
</span><span class="c1"></span>  <span class="nx">onMounted</span><span class="p">(()=&gt;{</span>
    <span class="nx">getDog</span><span class="p">()</span>
  <span class="p">})</span>
  	
  <span class="c1">//向外部暴露数据
</span><span class="c1"></span>  <span class="k">return</span> <span class="p">{</span><span class="nx">dogList</span><span class="p">,</span><span class="nx">getDog</span><span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>组件中具体使用：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{{</span><span class="nx">sum</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;increment&#34;</span><span class="p">&gt;</span><span class="na">点我</span><span class="err">+</span><span class="na">1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;decrement&#34;</span><span class="p">&gt;</span><span class="na">点我</span><span class="nt">-1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">hr</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">img</span> <span class="nt">v-for</span><span class="s">=&#34;(u,index) in dogList.urlList&#34; :key=&#34;index&#34; :src=&#34;(u as string)&#34;&gt; 
</span><span class="s">  &lt;span v-show=&#34;dogList.isLoading&#34;&gt;加载中......&lt;/span&gt;&lt;br&gt;
</span><span class="s">  &lt;button @click=&#34;getDog&#34;&gt;再来一只狗&lt;/button&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">  
</span><span class="s">&lt;script lang=&#34;ts&#34;&gt;
</span><span class="s">  import {defineComponent} from &#39;vue&#39;
</span><span class="s">  
</span><span class="s">  export default defineComponent({
</span><span class="s">    name:&#39;App&#39;,
</span><span class="s">  })
</span><span class="s">&lt;/script&gt;
</span><span class="s">  
</span><span class="s">&lt;script setup lang=&#34;ts&#34;</span><span class="p">&gt;</span>
  <span class="na">import</span> <span class="na">useSum</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">.</span><span class="err">/</span><span class="na">hooks</span><span class="err">/</span><span class="na">useSum</span><span class="err">&#39;</span>
  <span class="na">import</span> <span class="na">useDog</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">.</span><span class="err">/</span><span class="na">hooks</span><span class="err">/</span><span class="na">useDog</span><span class="err">&#39;</span>
  	
  <span class="na">let</span> <span class="p">{</span><span class="na">sum</span><span class="err">,</span><span class="na">increment</span><span class="err">,</span><span class="na">decrement</span><span class="p">}</span> <span class="err">=</span> <span class="na">useSum</span><span class="err">()</span>
  <span class="na">let</span> <span class="p">{</span><span class="na">dogList</span><span class="err">,</span><span class="na">getDog</span><span class="p">}</span> <span class="err">=</span> <span class="na">useDog</span><span class="err">()</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="4-路由">4. 路由</h1>
<h2 id="41-对路由的理解">4.1. 【对路由的理解】</h2>
<p><img src="/images/image-20231018144351536.png" alt="image-20231018144351536" title="image-20231018144351536">
<!-- raw HTML omitted --></p>
<h2 id="42-基本切换效果">4.2. 【基本切换效果】</h2>
<ul>
<li>
<p><code>Vue3</code>中要使用<code>vue-router</code>的最新版本，目前是<code>4</code>版本。</p>
</li>
<li>
<p>路由配置文件代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span><span class="nx">createRouter</span><span class="p">,</span><span class="nx">createWebHistory</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-router&#39;</span>
<span class="kr">import</span> <span class="nx">Home</span> <span class="nx">from</span> <span class="s1">&#39;@/pages/Home.vue&#39;</span>
<span class="kr">import</span> <span class="nx">News</span> <span class="nx">from</span> <span class="s1">&#39;@/pages/News.vue&#39;</span>
<span class="kr">import</span> <span class="nx">About</span> <span class="nx">from</span> <span class="s1">&#39;@/pages/About.vue&#39;</span>
  
<span class="kr">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">createRouter</span><span class="p">({</span>
  <span class="nx">history</span><span class="o">:</span><span class="nx">createWebHistory</span><span class="p">(),</span>
  <span class="nx">routes</span><span class="o">:</span><span class="p">[</span>
      <span class="p">{</span>
          <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;/home&#39;</span><span class="p">,</span>
          <span class="nx">component</span><span class="o">:</span><span class="nx">Home</span>
      <span class="p">},</span>
      <span class="p">{</span>
          <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;/about&#39;</span><span class="p">,</span>
          <span class="nx">component</span><span class="o">:</span><span class="nx">About</span>
      <span class="p">}</span>
  <span class="p">]</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="nx">router</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<ul>
<li>
<p><code>main.ts</code>代码如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">router</span> <span class="nx">from</span> <span class="s1">&#39;./router/index&#39;</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">router</span><span class="p">)</span>
  
<span class="nx">app</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="s1">&#39;#app&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<ul>
<li>
<p><code>App.vue</code>代码如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;app&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;title&#34;</span><span class="p">&gt;</span><span class="nx">Vue路由测试</span><span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    <span class="c">&lt;!--</span> <span class="nx">导航区</span> <span class="o">--&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;navigate&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">RouterLink</span> <span class="na">to</span><span class="o">=</span><span class="s">&#34;/home&#34;</span> <span class="na">active</span><span class="nt">-class</span><span class="err">=&#34;</span><span class="na">active</span><span class="err">&#34;</span><span class="p">&gt;</span><span class="nx">首页</span><span class="p">&lt;/</span><span class="nt">RouterLink</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">RouterLink</span> <span class="na">to</span><span class="o">=</span><span class="s">&#34;/news&#34;</span> <span class="na">active</span><span class="nt">-class</span><span class="err">=&#34;</span><span class="na">active</span><span class="err">&#34;</span><span class="p">&gt;</span><span class="nx">新闻</span><span class="p">&lt;/</span><span class="nt">RouterLink</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">RouterLink</span> <span class="na">to</span><span class="o">=</span><span class="s">&#34;/about&#34;</span> <span class="na">active</span><span class="nt">-class</span><span class="err">=&#34;</span><span class="na">active</span><span class="err">&#34;</span><span class="p">&gt;</span><span class="nx">关于</span><span class="p">&lt;/</span><span class="nt">RouterLink</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="c">&lt;!--</span> <span class="nx">展示区</span> <span class="o">--&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;main-content&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">RouterView</span><span class="p">&gt;&lt;/</span><span class="nt">RouterView</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
  
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">setup</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;App&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span><span class="nx">RouterLink</span><span class="p">,</span><span class="nx">RouterView</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-router&#39;</span>  
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="43-两个注意点">4.3. 【两个注意点】</h2>
<blockquote>
<ol>
<li>
<p>路由组件通常存放在<code>pages</code> 或 <code>views</code>文件夹，一般组件通常存放在<code>components</code>文件夹。</p>
</li>
<li>
<p>通过点击导航，视觉效果上“消失” 了的路由组件，默认是被<strong>卸载</strong>掉的，需要的时候再去<strong>挂载</strong>。</p>
</li>
</ol>
</blockquote>
<h2 id="44路由器工作模式">4.4.【路由器工作模式】</h2>
<ol>
<li>
<p><code>history</code>模式</p>
<blockquote>
<p>优点：<code>URL</code>更加美观，不带有<code>#</code>，更接近传统的网站<code>URL</code>。</p>
<p>缺点：后期项目上线，需要服务端配合处理路径问题，否则刷新会有<code>404</code>错误。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">createRouter</span><span class="p">({</span>
  	<span class="nx">history</span><span class="o">:</span><span class="nx">createWebHistory</span><span class="p">(),</span> <span class="c1">//history模式
</span><span class="c1"></span>  	<span class="cm">/******/</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div></blockquote>
</li>
<li>
<p><code>hash</code>模式</p>
<blockquote>
<p>优点：兼容性更好，因为不需要服务器端处理路径。</p>
<p>缺点：<code>URL</code>带有<code>#</code>不太美观，且在<code>SEO</code>优化方面相对较差。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">createRouter</span><span class="p">({</span>
  	<span class="nx">history</span><span class="o">:</span><span class="nx">createWebHashHistory</span><span class="p">(),</span> <span class="c1">//hash模式
</span><span class="c1"></span>  	<span class="cm">/******/</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div></blockquote>
</li>
</ol>
<h2 id="45-to的两种写法">4.5. 【to的两种写法】</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="c">&lt;!--</span> <span class="nx">第一种</span><span class="err">：</span><span class="nx">to的字符串写法</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">router-link</span> <span class="na">active</span><span class="nt">-class</span><span class="err">=&#34;</span><span class="na">active</span><span class="err">&#34;</span> <span class="na">to</span><span class="o">=</span><span class="s">&#34;/home&#34;</span><span class="p">&gt;</span><span class="nx">主页</span><span class="o">&lt;</span><span class="err">/router-link&gt;</span>

<span class="c">&lt;!--</span> <span class="nx">第二种</span><span class="err">：</span><span class="nx">to的对象写法</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">router-link</span> <span class="na">active</span><span class="nt">-class</span><span class="err">=&#34;</span><span class="na">active</span><span class="err">&#34;</span> <span class="nt">:to</span><span class="s">=&#34;{path:&#39;/home&#39;}&#34;</span><span class="p">&gt;</span><span class="nx">Home</span><span class="o">&lt;</span><span class="err">/router-link&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="46-命名路由">4.6. 【命名路由】</h2>
<p>作用：可以简化路由跳转及传参（后面就讲）。</p>
<p>给路由规则命名：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="nx">routes</span><span class="o">:</span><span class="p">[</span>
  <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;zhuye&#39;</span><span class="p">,</span>
    <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;/home&#39;</span><span class="p">,</span>
    <span class="nx">component</span><span class="o">:</span><span class="nx">Home</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;xinwen&#39;</span><span class="p">,</span>
    <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;/news&#39;</span><span class="p">,</span>
    <span class="nx">component</span><span class="o">:</span><span class="nx">News</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;guanyu&#39;</span><span class="p">,</span>
    <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;/about&#39;</span><span class="p">,</span>
    <span class="nx">component</span><span class="o">:</span><span class="nx">About</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p>跳转路由：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="c">&lt;!--</span><span class="nx">简化前</span><span class="err">：</span><span class="nx">需要写完整的路径</span><span class="err">（</span><span class="nx">to的字符串写法</span><span class="err">）</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">router-link</span> <span class="na">to</span><span class="o">=</span><span class="s">&#34;/news/detail&#34;</span><span class="p">&gt;</span><span class="nx">跳转</span><span class="o">&lt;</span><span class="err">/router-link&gt;</span>

<span class="c">&lt;!--</span><span class="nx">简化后</span><span class="err">：</span><span class="nx">直接通过名字跳转</span><span class="err">（</span><span class="nx">to的对象写法配合name属性</span><span class="err">）</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">router-link</span> <span class="nt">:to</span><span class="s">=&#34;{name:&#39;guanyu&#39;}&#34;</span><span class="p">&gt;</span><span class="nx">跳转</span><span class="o">&lt;</span><span class="err">/router-link&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="47-嵌套路由">4.7. 【嵌套路由】</h2>
<ol>
<li>
<p>编写<code>News</code>的子路由：<code>Detail.vue</code></p>
</li>
<li>
<p>配置路由规则，使用<code>children</code>配置项：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ts" data-lang="ts"><span class="kr">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">createRouter</span><span class="p">({</span>
  <span class="nx">history</span>:<span class="kt">createWebHistory</span><span class="p">(),</span>
 <span class="nx">routes</span><span class="o">:</span><span class="p">[</span>
     <span class="p">{</span>
         <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;zhuye&#39;</span><span class="p">,</span>
         <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;/home&#39;</span><span class="p">,</span>
         <span class="nx">component</span>:<span class="kt">Home</span>
     <span class="p">},</span>
     <span class="p">{</span>
         <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;xinwen&#39;</span><span class="p">,</span>
         <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;/news&#39;</span><span class="p">,</span>
         <span class="nx">component</span>:<span class="kt">News</span><span class="p">,</span>
         <span class="nx">children</span><span class="o">:</span><span class="p">[</span>
             <span class="p">{</span>
                 <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;xiang&#39;</span><span class="p">,</span>
                 <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;detail&#39;</span><span class="p">,</span>
                 <span class="nx">component</span>:<span class="kt">Detail</span>
             <span class="p">}</span>
         <span class="p">]</span>
     <span class="p">},</span>
     <span class="p">{</span>
         <span class="nx">name</span><span class="o">:</span><span class="s1">&#39;guanyu&#39;</span><span class="p">,</span>
         <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;/about&#39;</span><span class="p">,</span>
         <span class="nx">component</span>:<span class="kt">About</span>
     <span class="p">}</span>
 <span class="p">]</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="k">default</span> <span class="nx">router</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>跳转路由（记得要加完整路径）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">router-link</span> <span class="na">to</span><span class="o">=</span><span class="s">&#34;/news/detail&#34;</span><span class="p">&gt;</span><span class="nx">xxxx</span><span class="o">&lt;</span><span class="err">/router-link&gt;</span>
<span class="c">&lt;!--</span> <span class="nx">或</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">router-link</span> <span class="nt">:to</span><span class="s">=&#34;{path:&#39;/news/detail&#39;}&#34;</span><span class="p">&gt;</span><span class="nx">xxxx</span><span class="o">&lt;</span><span class="err">/router-link&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>记得去<code>Home</code>组件中预留一个<code>&lt;router-view&gt;</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;news&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">nav</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;news-list&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">RouterLink</span> <span class="nt">v-for</span><span class="s">=&#34;news in newsList&#34; :key=&#34;news.id&#34; :to=&#34;{path:&#39;/news/detail&#39;}&#34;&gt;
</span><span class="s">        {{news.name}}
</span><span class="s">      &lt;/RouterLink&gt;
</span><span class="s">    &lt;/nav&gt;
</span><span class="s">    &lt;div class=&#34;news-detail&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">RouterView</span><span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="48-路由传参">4.8. 【路由传参】</h2>
<h3 id="query参数">query参数</h3>
<ol>
<li>
<p>传递参数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="c">&lt;!--</span> <span class="nx">跳转并携带query参数</span><span class="err">（</span><span class="nx">to的字符串写法</span><span class="err">）</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">router-link</span> <span class="na">to</span><span class="o">=</span><span class="s">&#34;/news/detail?a=1&amp;b=2&amp;content=欢迎你&#34;</span><span class="p">&gt;</span>
  <span class="nx">跳转</span>
<span class="o">&lt;</span><span class="err">/router-link&gt;</span>
      				
<span class="c">&lt;!--</span> <span class="nx">跳转并携带query参数</span><span class="err">（</span><span class="nx">to的对象写法</span><span class="err">）</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">RouterLink</span> 
  <span class="o">:</span><span class="na">to</span><span class="o">=</span><span class="s">&#34;{
</span><span class="s">    //name:&#39;xiang&#39;, //用name也可以跳转
</span><span class="s">    path:&#39;/news/detail&#39;,
</span><span class="s">    query:{
</span><span class="s">      id:news.id,
</span><span class="s">      title:news.title,
</span><span class="s">      content:news.content
</span><span class="s">    }
</span><span class="s">  }&#34;</span>
<span class="p">&gt;</span>
  <span class="p">{{</span><span class="nx">news</span><span class="p">.</span><span class="nx">title</span><span class="p">}}</span>
<span class="p">&lt;/</span><span class="nt">RouterLink</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>接收参数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span><span class="nx">useRoute</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-router&#39;</span>
<span class="kr">const</span> <span class="nx">route</span> <span class="o">=</span> <span class="nx">useRoute</span><span class="p">()</span>
<span class="c1">// 打印query参数
</span><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">route</span><span class="p">.</span><span class="nx">query</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="params参数">params参数</h3>
<ol>
<li>
<p>传递参数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="c">&lt;!--</span> <span class="nx">跳转并携带params参数</span><span class="err">（</span><span class="nx">to的字符串写法</span><span class="err">）</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">RouterLink</span> <span class="nt">:to</span><span class="s">=&#34;`/news/detail/001/新闻001/内容001`&#34;</span><span class="p">&gt;{{</span><span class="nx">news</span><span class="p">.</span><span class="nx">title</span><span class="p">}}&lt;/</span><span class="nt">RouterLink</span><span class="p">&gt;</span>
      				
<span class="c">&lt;!--</span> <span class="nx">跳转并携带params参数</span><span class="err">（</span><span class="nx">to的对象写法</span><span class="err">）</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">RouterLink</span> 
  <span class="o">:</span><span class="na">to</span><span class="o">=</span><span class="s">&#34;{
</span><span class="s">    name:&#39;xiang&#39;, //用name跳转
</span><span class="s">    params:{
</span><span class="s">      id:news.id,
</span><span class="s">      title:news.title,
</span><span class="s">      content:news.title
</span><span class="s">    }
</span><span class="s">  }&#34;</span>
<span class="p">&gt;</span>
  <span class="p">{{</span><span class="nx">news</span><span class="p">.</span><span class="nx">title</span><span class="p">}}</span>
<span class="p">&lt;/</span><span class="nt">RouterLink</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>接收参数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span><span class="nx">useRoute</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-router&#39;</span>
<span class="kr">const</span> <span class="nx">route</span> <span class="o">=</span> <span class="nx">useRoute</span><span class="p">()</span>
<span class="c1">// 打印params参数
</span><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">route</span><span class="p">.</span><span class="nx">params</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<blockquote>
<p>备注1：传递<code>params</code>参数时，若使用<code>to</code>的对象写法，必须使用<code>name</code>配置项，不能用<code>path</code>。</p>
<p>备注2：传递<code>params</code>参数时，需要提前在规则中占位。</p>
</blockquote>
<h2 id="49-路由的props配置">4.9. 【路由的props配置】</h2>
<p>作用：让路由组件更方便的收到参数（可以将路由参数作为<code>props</code>传给组件）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">{</span>
	<span class="nx">name</span><span class="o">:</span><span class="s1">&#39;xiang&#39;</span><span class="p">,</span>
	<span class="nx">path</span><span class="o">:</span><span class="s1">&#39;detail/:id/:title/:content&#39;</span><span class="p">,</span>
	<span class="nx">component</span><span class="o">:</span><span class="nx">Detail</span><span class="p">,</span>

  <span class="c1">// props的对象写法，作用：把对象中的每一组key-value作为props传给Detail组件
</span><span class="c1"></span>  <span class="c1">// props:{a:1,b:2,c:3}, 
</span><span class="c1"></span>
  <span class="c1">// props的布尔值写法，作用：把收到了每一组params参数，作为props传给Detail组件
</span><span class="c1"></span>  <span class="c1">// props:true
</span><span class="c1"></span>  
  <span class="c1">// props的函数写法，作用：把返回的对象中每一组key-value作为props传给Detail组件
</span><span class="c1"></span>  <span class="nx">props</span><span class="p">(</span><span class="nx">route</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">route</span><span class="p">.</span><span class="nx">query</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="410--replace属性">4.10. 【 replace属性】</h2>
<ol>
<li>
<p>作用：控制路由跳转时操作浏览器历史记录的模式。</p>
</li>
<li>
<p>浏览器的历史记录有两种写入方式：分别为<code>push</code>和<code>replace</code>：</p>
<ul>
<li><code>push</code>是追加历史记录（默认值）。</li>
<li><code>replace</code>是替换当前记录。</li>
</ul>
</li>
<li>
<p>开启<code>replace</code>模式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">RouterLink</span> <span class="na">replace</span> <span class="na">.......</span><span class="p">&gt;</span><span class="nx">News</span><span class="p">&lt;/</span><span class="nt">RouterLink</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="411-编程式导航">4.11. 【编程式导航】</h2>
<p>路由组件的两个重要的属性：<code>$route</code>和<code>$router</code>变成了两个<code>hooks</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span><span class="nx">useRoute</span><span class="p">,</span><span class="nx">useRouter</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue-router&#39;</span>

<span class="kr">const</span> <span class="nx">route</span> <span class="o">=</span> <span class="nx">useRoute</span><span class="p">()</span>
<span class="kr">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">useRouter</span><span class="p">()</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">route</span><span class="p">.</span><span class="nx">query</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">route</span><span class="p">.</span><span class="nx">parmas</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">router</span><span class="p">.</span><span class="nx">replace</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="412-重定向">4.12. 【重定向】</h2>
<ol>
<li>
<p>作用：将特定的路径，重新定向到已有路由。</p>
</li>
<li>
<p>具体编码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="p">{</span>
    <span class="nx">path</span><span class="o">:</span><span class="s1">&#39;/&#39;</span><span class="p">,</span>
    <span class="nx">redirect</span><span class="o">:</span><span class="s1">&#39;/about&#39;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h1 id="5-pinia">5. pinia</h1>
<h2 id="51准备一个效果">5.1【准备一个效果】</h2>
<p><img src="/images/pinia_example.gif" alt="pinia_example" title="pinia_example">
<!-- raw HTML omitted --></p>
<h2 id="52搭建-pinia-环境">5.2【搭建 pinia 环境】</h2>
<p>第一步：<code>npm install pinia</code></p>
<p>第二步：操作<code>src/main.ts</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ts" data-lang="ts"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createApp</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>
<span class="kr">import</span> <span class="nx">App</span> <span class="nx">from</span> <span class="s1">&#39;./App.vue&#39;</span>

<span class="cm">/* 引入createPinia，用于创建pinia */</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">createPinia</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;pinia&#39;</span>

<span class="cm">/* 创建pinia */</span>
<span class="kr">const</span> <span class="nx">pinia</span> <span class="o">=</span> <span class="nx">createPinia</span><span class="p">()</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">createApp</span><span class="p">(</span><span class="nx">App</span><span class="p">)</span>

<span class="cm">/* 使用插件 */</span><span class="p">{}</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">pinia</span><span class="p">)</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="s1">&#39;#app&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>此时开发者工具中已经有了<code>pinia</code>选项</p>
<p><img src="/images/1684309952481-c67f67f9-d1a3-4d69-8bd6-2b381e003f31.png" alt="pinia" title="pinia">
<!-- raw HTML omitted --></p>
<h2 id="53存储读取数据">5.3【存储+读取数据】</h2>
<ol>
<li>
<p><code>Store</code>是一个保存：<strong>状态</strong>、<strong>业务逻辑</strong> 的实体，每个组件都可以<strong>读取</strong>、<strong>写入</strong>它。</p>
</li>
<li>
<p>它有三个概念：<code>state</code>、<code>getter</code>、<code>action</code>，相当于组件中的： <code>data</code>、 <code>computed</code> 和 <code>methods</code>。</p>
</li>
<li>
<p>具体编码：<code>src/store/count.ts</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ts" data-lang="ts"><span class="c1">// 引入defineStore用于创建store
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">defineStore</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;pinia&#39;</span>
   
<span class="c1">// 定义并暴露一个store
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">useCountStore</span> <span class="o">=</span> <span class="nx">defineStore</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,{</span>
  <span class="c1">// 动作
</span><span class="c1"></span>  <span class="nx">actions</span><span class="o">:</span><span class="p">{},</span>
  <span class="c1">// 状态
</span><span class="c1"></span>  <span class="nx">state</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">sum</span>:<span class="kt">6</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="c1">// 计算
</span><span class="c1"></span>  <span class="nx">getters</span><span class="o">:</span><span class="p">{}</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>具体编码：<code>src/store/talk.ts</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入defineStore用于创建store
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">defineStore</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;pinia&#39;</span>
   
<span class="c1">// 定义并暴露一个store
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">useTalkStore</span> <span class="o">=</span> <span class="nx">defineStore</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">,{</span>
  <span class="c1">// 动作
</span><span class="c1"></span>  <span class="nx">actions</span><span class="o">:</span><span class="p">{},</span>
  <span class="c1">// 状态
</span><span class="c1"></span>  <span class="nx">state</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">talkList</span><span class="o">:</span><span class="p">[</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;yuysada01&#39;</span><span class="p">,</span><span class="nx">content</span><span class="o">:</span><span class="s1">&#39;你今天有点怪，哪里怪？怪好看的！&#39;</span><span class="p">},</span>
             <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;yuysada02&#39;</span><span class="p">,</span><span class="nx">content</span><span class="o">:</span><span class="s1">&#39;草莓、蓝莓、蔓越莓，你想我了没？&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;yuysada03&#39;</span><span class="p">,</span><span class="nx">content</span><span class="o">:</span><span class="s1">&#39;心里给你留了一块地，我的死心塌地&#39;</span><span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="c1">// 计算
</span><span class="c1"></span>  <span class="nx">getters</span><span class="o">:</span><span class="p">{}</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>组件中使用<code>state</code>中的数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{{</span> <span class="nx">sumStore</span><span class="p">.</span><span class="nx">sum</span> <span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
   
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Count&#34;</span><span class="p">&gt;</span>
  <span class="c1">// 引入对应的useXxxxxStore	
</span><span class="c1"></span>  <span class="kr">import</span> <span class="p">{</span><span class="nx">useSumStore</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@/store/sum&#39;</span>
     
  <span class="c1">// 调用useXxxxxStore得到对应的store
</span><span class="c1"></span>  <span class="kr">const</span> <span class="nx">sumStore</span> <span class="o">=</span> <span class="nx">useSumStore</span><span class="p">()</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;talk in talkStore.talkList&#34; :key=&#34;talk.id&#34;&gt;
</span><span class="s">      {{ talk.content }}
</span><span class="s">    &lt;/li&gt;
</span><span class="s">  &lt;/ul&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">   
</span><span class="s">&lt;script setup lang=&#34;ts&#34; name=&#34;Count&#34;</span><span class="p">&gt;</span>
  <span class="na">import</span> <span class="na">axios</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">axios</span><span class="err">&#39;</span>
  <span class="na">import</span> <span class="p">{</span><span class="na">useTalkStore</span><span class="p">}</span> <span class="na">from</span> <span class="err">&#39;@/</span><span class="na">store</span><span class="err">/</span><span class="na">talk</span><span class="err">&#39;</span>
   
  <span class="na">const</span> <span class="na">talkStore </span><span class="o">=</span> <span class="na">useTalkStore</span><span class="err">()</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="54修改数据三种方式">5.4.【修改数据】(三种方式)</h2>
<ol>
<li>
<p>第一种修改方式，直接修改</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ts" data-lang="ts"><span class="nx">countStore</span><span class="p">.</span><span class="nx">sum</span> <span class="o">=</span> <span class="mi">666</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>第二种修改方式：批量修改</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ts" data-lang="ts"><span class="nx">countStore</span><span class="p">.</span><span class="nx">$patch</span><span class="p">({</span>
  <span class="nx">sum</span>:<span class="kt">999</span><span class="p">,</span>
  <span class="nx">school</span><span class="o">:</span><span class="s1">&#39;atguigu&#39;</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>第三种修改方式：借助<code>action</code>修改（<code>action</code>中可以编写一些业务逻辑）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">defineStore</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;pinia&#39;</span>
   
<span class="kr">export</span> <span class="kr">const</span> <span class="nx">useCountStore</span> <span class="o">=</span> <span class="nx">defineStore</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="cm">/*************/</span>
  <span class="nx">actions</span><span class="o">:</span> <span class="p">{</span>
    <span class="c1">//加
</span><span class="c1"></span>    <span class="nx">increment</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="nx">number</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">sum</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//操作countStore中的sum
</span><span class="c1"></span>        <span class="k">this</span><span class="p">.</span><span class="nx">sum</span> <span class="o">+=</span> <span class="nx">value</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="c1">//减
</span><span class="c1"></span>    <span class="nx">decrement</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="nx">number</span><span class="p">){</span>
      <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">sum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">sum</span> <span class="o">-=</span> <span class="nx">value</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="cm">/*************/</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>组件中调用<code>action</code>即可</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 使用countStore
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">countStore</span> <span class="o">=</span> <span class="nx">useCountStore</span><span class="p">()</span>
   
<span class="c1">// 调用对应action
</span><span class="c1"></span><span class="nx">countStore</span><span class="p">.</span><span class="nx">incrementOdd</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="55storetorefs">5.5.【storeToRefs】</h2>
<ul>
<li>借助<code>storeToRefs</code>将<code>store</code>中的数据转为<code>ref</code>对象，方便在模板中使用。</li>
<li>注意：<code>pinia</code>提供的<code>storeToRefs</code>只会将数据做转换，而<code>Vue</code>的<code>toRefs</code>会转换<code>store</code>中数据。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;count&#34;</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span><span class="nx">当前求和为</span><span class="err">：</span><span class="p">{{</span><span class="nx">sum</span><span class="p">}}&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
	<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Count&#34;</span><span class="p">&gt;</span>
  <span class="kr">import</span> <span class="p">{</span> <span class="nx">useCountStore</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@/store/count&#39;</span>
  <span class="cm">/* 引入storeToRefs */</span>
  <span class="kr">import</span> <span class="p">{</span> <span class="nx">storeToRefs</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;pinia&#39;</span>

	<span class="cm">/* 得到countStore */</span>
  <span class="kr">const</span> <span class="nx">countStore</span> <span class="o">=</span> <span class="nx">useCountStore</span><span class="p">()</span>
  <span class="cm">/* 使用storeToRefs转换countStore，随后解构 */</span>
  <span class="kr">const</span> <span class="p">{</span><span class="nx">sum</span><span class="p">}</span> <span class="o">=</span> <span class="nx">storeToRefs</span><span class="p">(</span><span class="nx">countStore</span><span class="p">)</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

</code></pre></td></tr></table>
</div>
</div><h2 id="56getters">5.6.【getters】</h2>
<ol>
<li>
<p>概念：当<code>state</code>中的数据，需要经过处理后再使用时，可以使用<code>getters</code>配置。</p>
</li>
<li>
<p>追加<code>getters</code>配置。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 引入defineStore用于创建store
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span><span class="nx">defineStore</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;pinia&#39;</span>
     
<span class="c1">// 定义并暴露一个store
</span><span class="c1"></span><span class="kr">export</span> <span class="kr">const</span> <span class="nx">useCountStore</span> <span class="o">=</span> <span class="nx">defineStore</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,{</span>
  <span class="c1">// 动作
</span><span class="c1"></span>  <span class="nx">actions</span><span class="o">:</span><span class="p">{</span>
    <span class="cm">/************/</span>
  <span class="p">},</span>
  <span class="c1">// 状态
</span><span class="c1"></span>  <span class="nx">state</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">sum</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
      <span class="nx">school</span><span class="o">:</span><span class="s1">&#39;atguigu&#39;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="c1">// 计算
</span><span class="c1"></span>  <span class="nx">getters</span><span class="o">:</span><span class="p">{</span>
    <span class="nx">bigSum</span><span class="o">:</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span><span class="o">:</span><span class="nx">number</span> <span class="p">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">sum</span> <span class="o">*</span><span class="mi">10</span><span class="p">,</span>
    <span class="nx">upperSchool</span><span class="p">()</span><span class="o">:</span><span class="nx">string</span><span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span> <span class="nx">school</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>组件中读取数据：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="p">{</span><span class="nx">increment</span><span class="p">,</span><span class="nx">decrement</span><span class="p">}</span> <span class="o">=</span> <span class="nx">countStore</span>
<span class="kd">let</span> <span class="p">{</span><span class="nx">sum</span><span class="p">,</span><span class="nx">school</span><span class="p">,</span><span class="nx">bigSum</span><span class="p">,</span><span class="nx">upperSchool</span><span class="p">}</span> <span class="o">=</span> <span class="nx">storeToRefs</span><span class="p">(</span><span class="nx">countStore</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="57subscribe">5.7.【$subscribe】</h2>
<p>通过 store 的 <code>$subscribe()</code> 方法侦听 <code>state</code> 及其变化</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ts" data-lang="ts"><span class="nx">talkStore</span><span class="p">.</span><span class="nx">$subscribe</span><span class="p">((</span><span class="nx">mutate</span><span class="p">,</span><span class="nx">state</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;LoveTalk&#39;</span><span class="p">,</span><span class="nx">mutate</span><span class="p">,</span><span class="nx">state</span><span class="p">)</span>
  <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">talkList</span><span class="p">.</span><span class="nx">value</span><span class="p">))</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="58-store组合式写法">5.8. 【store组合式写法】</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ts" data-lang="ts"><span class="kr">import</span> <span class="p">{</span><span class="nx">defineStore</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;pinia&#39;</span>
<span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">&#39;axios&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">nanoid</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;nanoid&#39;</span>
<span class="kr">import</span> <span class="p">{</span><span class="nx">reactive</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span>

<span class="kr">export</span> <span class="kr">const</span> <span class="nx">useTalkStore</span> <span class="o">=</span> <span class="nx">defineStore</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">,()</span><span class="o">=&gt;</span><span class="p">{</span>
  <span class="c1">// talkList就是state
</span><span class="c1"></span>  <span class="kr">const</span> <span class="nx">talkList</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">(</span>
    <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;talkList&#39;</span><span class="p">)</span> <span class="kr">as</span> <span class="kt">string</span><span class="p">)</span> <span class="o">||</span> <span class="p">[]</span>
  <span class="p">)</span>

  <span class="c1">// getATalk函数相当于action
</span><span class="c1"></span>  <span class="nx">async</span> <span class="kd">function</span> <span class="nx">getATalk</span><span class="p">(){</span>
    <span class="c1">// 发请求，下面这行的写法是：连续解构赋值+重命名
</span><span class="c1"></span>    <span class="kd">let</span> <span class="p">{</span><span class="nx">data</span><span class="o">:</span><span class="p">{</span><span class="nx">content</span>:<span class="kt">title</span><span class="p">}}</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;https://api.uomg.com/api/rand.qinghua?format=json&#39;</span><span class="p">)</span>
    <span class="c1">// 把请求回来的字符串，包装成一个对象
</span><span class="c1"></span>    <span class="kd">let</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">id</span>:<span class="kt">nanoid</span><span class="p">(),</span><span class="nx">title</span><span class="p">}</span>
    <span class="c1">// 放到数组中
</span><span class="c1"></span>    <span class="nx">talkList</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="p">{</span><span class="nx">talkList</span><span class="p">,</span><span class="nx">getATalk</span><span class="p">}</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="6-组件通信">6. 组件通信</h1>
<p><strong><code>Vue3</code>组件通信和<code>Vue2</code>的区别：</strong></p>
<ul>
<li>移出事件总线，使用<code>mitt</code>代替。</li>
</ul>
<ul>
<li><code>vuex</code>换成了<code>pinia</code>。</li>
<li>把<code>.sync</code>优化到了<code>v-model</code>里面了。</li>
<li>把<code>$listeners</code>所有的东西，合并到<code>$attrs</code>中了。</li>
<li><code>$children</code>被砍掉了。</li>
</ul>
<p><strong>常见搭配形式：</strong></p>
<p><img src="/images/image-20231119185900990.png" alt="image-20231119185900990" title="image-20231119185900990">
<!-- raw HTML omitted --></p>
<h2 id="61-props">6.1. 【props】</h2>
<p>概述：<code>props</code>是使用频率最高的一种通信方式，常用与 ：<strong>父 ↔ 子</strong>。</p>
<ul>
<li>若 <strong>父传子</strong>：属性值是<strong>非函数</strong>。</li>
<li>若 <strong>子传父</strong>：属性值是<strong>函数</strong>。</li>
</ul>
<p>父组件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;father&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">父组件</span><span class="err">，</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">我的车</span><span class="err">：</span><span class="p">{{</span> <span class="nx">car</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">儿子给的玩具</span><span class="err">：</span><span class="p">{{</span> <span class="nx">toy</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">Child</span> <span class="nt">:car</span><span class="s">=&#34;car&#34;</span> <span class="nt">:getToy</span><span class="s">=&#34;getToy&#34;</span><span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Father&#34;</span><span class="p">&gt;</span>
	<span class="kr">import</span> <span class="nx">Child</span> <span class="nx">from</span> <span class="s1">&#39;./Child.vue&#39;</span>
	<span class="kr">import</span> <span class="p">{</span> <span class="nx">ref</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;vue&#34;</span><span class="p">;</span>
	<span class="c1">// 数据
</span><span class="c1"></span>	<span class="kr">const</span> <span class="nx">car</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="s1">&#39;奔驰&#39;</span><span class="p">)</span>
	<span class="kr">const</span> <span class="nx">toy</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">()</span>
	<span class="c1">// 方法
</span><span class="c1"></span>	<span class="kd">function</span> <span class="nx">getToy</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="nx">string</span><span class="p">){</span>
		<span class="nx">toy</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span>
	<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>子组件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;child&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">子组件</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">我的玩具</span><span class="err">：</span><span class="p">{{</span> <span class="nx">toy</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">父给我的车</span><span class="err">：</span><span class="p">{{</span> <span class="nx">car</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;getToy(toy)&#34;</span><span class="p">&gt;</span><span class="na">玩具给父亲</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Child&#34;</span><span class="p">&gt;</span>
	<span class="kr">import</span> <span class="p">{</span> <span class="nx">ref</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;vue&#34;</span><span class="p">;</span>
	<span class="kr">const</span> <span class="nx">toy</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="s1">&#39;奥特曼&#39;</span><span class="p">)</span>
	
	<span class="nx">defineProps</span><span class="p">([</span><span class="s1">&#39;car&#39;</span><span class="p">,</span><span class="s1">&#39;getToy&#39;</span><span class="p">])</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="62-自定义事件">6.2. 【自定义事件】</h2>
<ol>
<li>概述：自定义事件常用于：<strong>子 =&gt; 父。</strong></li>
<li>注意区分好：原生事件、自定义事件。</li>
</ol>
<ul>
<li>原生事件：
<ul>
<li>事件名是特定的（<code>click</code>、<code>mosueenter</code>等等）</li>
<li>事件对象<code>$event</code>: 是包含事件相关信息的对象（<code>pageX</code>、<code>pageY</code>、<code>target</code>、<code>keyCode</code>）</li>
</ul>
</li>
<li>自定义事件：
<ul>
<li>事件名是任意名称</li>
<li><!-- raw HTML omitted -->事件对象<code>$event</code>: 是调用<code>emit</code>时所提供的数据，可以是任意类型！！！<!-- raw HTML omitted --></li>
</ul>
</li>
</ul>
<ol start="3">
<li>
<p>示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="c">&lt;!--在父组件中，给子组件绑定自定义事件：--&gt;</span>
<span class="p">&lt;</span><span class="nt">Child</span> <span class="err">@</span><span class="na">send-toy</span><span class="o">=</span><span class="s">&#34;toy = $event&#34;</span><span class="p">/&gt;</span>
   
<span class="c">&lt;!--注意区分原生事件与自定义事件中的$event--&gt;</span>
<span class="p">&lt;</span><span class="nt">button</span> <span class="err">@</span><span class="na">click</span><span class="o">=</span><span class="s">&#34;toy = $event&#34;</span><span class="p">&gt;</span>测试<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">//子组件中，触发事件：
</span><span class="c1"></span><span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">&#39;send-toy&#39;</span><span class="p">,</span> <span class="nx">具体数据</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="63-mitt">6.3. 【mitt】</h2>
<p>概述：与消息订阅与发布（<code>pubsub</code>）功能类似，可以实现任意组件间通信。</p>
<p>安装<code>mitt</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">npm i mitt
</code></pre></td></tr></table>
</div>
</div><p>新建文件：<code>src\utils\emitter.ts</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// 引入mitt 
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">mitt</span> <span class="nx">from</span> <span class="s2">&#34;mitt&#34;</span><span class="p">;</span>

<span class="c1">// 创建emitter
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">emitter</span> <span class="o">=</span> <span class="nx">mitt</span><span class="p">()</span>

<span class="cm">/*
</span><span class="cm">  // 绑定事件
</span><span class="cm">  emitter.on(&#39;abc&#39;,(value)=&gt;{
</span><span class="cm">    console.log(&#39;abc事件被触发&#39;,value)
</span><span class="cm">  })
</span><span class="cm">  emitter.on(&#39;xyz&#39;,(value)=&gt;{
</span><span class="cm">    console.log(&#39;xyz事件被触发&#39;,value)
</span><span class="cm">  })
</span><span class="cm">
</span><span class="cm">  setInterval(() =&gt; {
</span><span class="cm">    // 触发事件
</span><span class="cm">    emitter.emit(&#39;abc&#39;,666)
</span><span class="cm">    emitter.emit(&#39;xyz&#39;,777)
</span><span class="cm">  }, 1000);
</span><span class="cm">
</span><span class="cm">  setTimeout(() =&gt; {
</span><span class="cm">    // 清理事件
</span><span class="cm">    emitter.all.clear()
</span><span class="cm">  }, 3000); 
</span><span class="cm">*/</span>

<span class="c1">// 创建并暴露mitt
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">emitter</span>
</code></pre></td></tr></table>
</div>
</div><p>接收数据的组件中：绑定事件、同时在销毁前解绑事件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-typescript" data-lang="typescript"><span class="kr">import</span> <span class="nx">emitter</span> <span class="nx">from</span> <span class="s2">&#34;@/utils/emitter&#34;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">onUnmounted</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;vue&#34;</span><span class="p">;</span>

<span class="c1">// 绑定事件
</span><span class="c1"></span><span class="nx">emitter</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;send-toy&#39;</span><span class="p">,(</span><span class="nx">value</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;send-toy事件被触发&#39;</span><span class="p">,</span><span class="nx">value</span><span class="p">)</span>
<span class="p">})</span>

<span class="nx">onUnmounted</span><span class="p">(()</span><span class="o">=&gt;</span><span class="p">{</span>
  <span class="c1">// 解绑事件
</span><span class="c1"></span>  <span class="nx">emitter</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;send-toy&#39;</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>【第三步】：提供数据的组件，在合适的时候触发事件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">import</span> <span class="nx">emitter</span> <span class="nx">from</span> <span class="s2">&#34;@/utils/emitter&#34;</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">sendToy</span><span class="p">(){</span>
  <span class="c1">// 触发事件
</span><span class="c1"></span>  <span class="nx">emitter</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">&#39;send-toy&#39;</span><span class="p">,</span><span class="nx">toy</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>注意这个重要的内置关系，总线依赖着这个内置关系</strong></p>
<h2 id="64v-model">6.4.【v-model】</h2>
<ol>
<li>
<p>概述：实现 <strong>父↔子</strong> 之间相互通信。</p>
</li>
<li>
<p>前序知识 —— <code>v-model</code>的本质</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="c">&lt;!--</span> <span class="nx">使用v</span><span class="o">-</span><span class="nx">model指令</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="nt">v-model</span><span class="s">=&#34;userName&#34;</span><span class="p">&gt;</span>
   
<span class="err">&lt;!--</span> <span class="na">v</span><span class="nt">-model的本质是下面这行代码</span> <span class="err">--</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">input</span> 
  <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> 
  <span class="nt">:value</span><span class="s">=&#34;userName&#34;</span> 
  <span class="err">@</span><span class="na">input</span><span class="o">=</span><span class="s">&#34;userName =(&lt;HTMLInputElement&gt;$event.target).value&#34;</span>
<span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>组件标签上的<code>v-model</code>的本质：<code>:moldeValue</code> ＋ <code>update:modelValue</code>事件。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="c">&lt;!--</span> <span class="nx">组件标签上使用v</span><span class="o">-</span><span class="nx">model指令</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">AtguiguInput</span> <span class="na">v</span><span class="nt">-model</span><span class="err">=&#34;</span><span class="na">userName</span><span class="err">&#34;</span><span class="p">/&gt;</span>
   
<span class="c">&lt;!--</span> <span class="nx">组件标签上v</span><span class="o">-</span><span class="nx">model的本质</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">AtguiguInput</span> <span class="nt">:modelValue</span><span class="s">=&#34;userName&#34;</span> <span class="err">@</span><span class="na">update</span><span class="o">:</span><span class="na">model</span><span class="nt">-value</span><span class="err">=&#34;</span><span class="na">userName </span><span class="o">=</span> <span class="err">$</span><span class="na">event</span><span class="err">&#34;</span><span class="p">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>AtguiguInput</code>组件中：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;box&#34;</span><span class="p">&gt;</span>
    <span class="c">&lt;!--</span><span class="nx">将接收的value值赋给input元素的value属性</span><span class="err">，</span><span class="nx">目的是</span><span class="err">：</span><span class="nx">为了呈现数据</span> <span class="o">--&gt;</span>
     <span class="c">&lt;!--</span><span class="nx">给input元素绑定原生input事件</span><span class="err">，</span><span class="nx">触发input事件时</span><span class="err">，</span><span class="nx">进而触发update</span><span class="o">:</span><span class="nx">model</span><span class="o">-</span><span class="nx">value事件</span><span class="o">--&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> 
       <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> 
       <span class="nt">:value</span><span class="s">=&#34;modelValue&#34;</span> 
       <span class="nt">@input</span><span class="s">=&#34;emit(&#39;update:model-value&#39;,$event.target.value)&#34;</span>
    <span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
   
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;AtguiguInput&#34;</span><span class="p">&gt;</span>
  <span class="c1">// 接收props
</span><span class="c1"></span>  <span class="nx">defineProps</span><span class="p">([</span><span class="s1">&#39;modelValue&#39;</span><span class="p">])</span>
  <span class="c1">// 声明事件
</span><span class="c1"></span>  <span class="kr">const</span> <span class="nx">emit</span> <span class="o">=</span> <span class="nx">defineEmits</span><span class="p">([</span><span class="s1">&#39;update:model-value&#39;</span><span class="p">])</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>也可以更换<code>value</code>，例如改成<code>abc</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="c">&lt;!--</span> <span class="nx">也可以更换value</span><span class="err">，</span><span class="nx">例如改成abc</span><span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">AtguiguInput</span> <span class="na">v</span><span class="nt">-model:abc</span><span class="s">=&#34;userName&#34;</span><span class="p">/&gt;</span>
   
<span class="c">&lt;!--</span> <span class="nx">上面代码的本质如下</span> <span class="o">--&gt;</span>
<span class="p">&lt;</span><span class="nt">AtguiguInput</span> <span class="nt">:abc</span><span class="s">=&#34;userName&#34;</span> <span class="err">@</span><span class="na">update</span><span class="o">:</span><span class="na">abc</span><span class="o">=</span><span class="s">&#34;userName = $event&#34;</span><span class="p">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>AtguiguInput</code>组件中：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;box&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> 
       <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> 
       <span class="nt">:value</span><span class="s">=&#34;abc&#34;</span> 
       <span class="nt">@input</span><span class="s">=&#34;emit(&#39;update:abc&#39;,$event.target.value)&#34;</span>
    <span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
   
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;AtguiguInput&#34;</span><span class="p">&gt;</span>
  <span class="c1">// 接收props
</span><span class="c1"></span>  <span class="nx">defineProps</span><span class="p">([</span><span class="s1">&#39;abc&#39;</span><span class="p">])</span>
  <span class="c1">// 声明事件
</span><span class="c1"></span>  <span class="kr">const</span> <span class="nx">emit</span> <span class="o">=</span> <span class="nx">defineEmits</span><span class="p">([</span><span class="s1">&#39;update:abc&#39;</span><span class="p">])</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>如果<code>value</code>可以更换，那么就可以在组件标签上多次使用<code>v-model</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">AtguiguInput</span> <span class="na">v</span><span class="nt">-model:abc</span><span class="s">=&#34;userName&#34;</span> <span class="na">v</span><span class="nt">-model:xyz</span><span class="s">=&#34;password&#34;</span><span class="p">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="65attrs-">6.5.【$attrs 】</h2>
<ol>
<li>
<p>概述：<code>$attrs</code>用于实现<strong>当前组件的父组件</strong>，向<strong>当前组件的子组件</strong>通信（<strong>祖→孙</strong>）。</p>
</li>
<li>
<p>具体说明：<code>$attrs</code>是一个对象，包含所有父组件传入的标签属性。</p>
<blockquote>
<p>注意：<code>$attrs</code>会自动排除<code>props</code>中声明的属性(可以认为声明过的 <code>props</code> 被子组件自己“消费”了)</p>
</blockquote>
</li>
</ol>
<p>父组件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;father&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">父组件</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">Child</span> <span class="nt">:a</span><span class="s">=&#34;a&#34;</span> <span class="nt">:b</span><span class="s">=&#34;b&#34;</span> <span class="nt">:c</span><span class="s">=&#34;c&#34;</span> <span class="nt">:d</span><span class="s">=&#34;d&#34;</span> <span class="nt">v-bind</span><span class="s">=&#34;{x:100,y:200}&#34; :updateA=&#34;updateA&#34;/&gt;
</span><span class="s">  &lt;/div&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">
</span><span class="s">&lt;script setup lang=&#34;ts&#34; name=&#34;Father&#34;</span><span class="p">&gt;</span>
	<span class="na">import</span> <span class="na">Child</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">.</span><span class="err">/</span><span class="na">Child.vue</span><span class="err">&#39;</span>
	<span class="na">import</span> <span class="p">{</span> <span class="na">ref</span> <span class="p">}</span> <span class="na">from</span> <span class="err">&#34;</span><span class="na">vue</span><span class="err">&#34;;</span>
	<span class="na">let</span> <span class="na">a </span><span class="o">=</span> <span class="na">ref</span><span class="err">(</span><span class="na">1</span><span class="err">)</span>
	<span class="na">let</span> <span class="na">b </span><span class="o">=</span> <span class="na">ref</span><span class="err">(</span><span class="na">2</span><span class="err">)</span>
	<span class="na">let</span> <span class="na">c </span><span class="o">=</span> <span class="na">ref</span><span class="err">(</span><span class="na">3</span><span class="err">)</span>
	<span class="na">let</span> <span class="na">d </span><span class="o">=</span> <span class="na">ref</span><span class="err">(</span><span class="na">4</span><span class="err">)</span>

	<span class="na">function</span> <span class="na">updateA</span><span class="err">(</span><span class="na">value</span><span class="err">)</span><span class="p">{</span>
		<span class="na">a.value</span> <span class="err">=</span> <span class="na">value</span>
	<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>子组件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;child&#34;</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">子组件</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">GrandChild</span> <span class="nt">v-bind</span><span class="s">=&#34;$attrs&#34;/&gt;
</span><span class="s">	&lt;/div&gt;
</span><span class="s">&lt;/template&gt;
</span><span class="s">
</span><span class="s">&lt;script setup lang=&#34;ts&#34; name=&#34;Child&#34;</span><span class="p">&gt;</span>
	<span class="na">import</span> <span class="na">GrandChild</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">.</span><span class="err">/</span><span class="na">GrandChild.vue</span><span class="err">&#39;</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>孙组件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;grand-child&#34;</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">孙组件</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">a</span><span class="err">：</span><span class="p">{{</span> <span class="nx">a</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">b</span><span class="err">：</span><span class="p">{{</span> <span class="nx">b</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">c</span><span class="err">：</span><span class="p">{{</span> <span class="nx">c</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">d</span><span class="err">：</span><span class="p">{{</span> <span class="nx">d</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">x</span><span class="err">：</span><span class="p">{{</span> <span class="nx">x</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">y</span><span class="err">：</span><span class="p">{{</span> <span class="nx">y</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;updateA(666)&#34;</span><span class="p">&gt;</span><span class="na">点我更新A</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
	<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;GrandChild&#34;</span><span class="p">&gt;</span>
	<span class="nx">defineProps</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;updateA&#39;</span><span class="p">])</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="66-refsparent">6.6. 【$refs、$parent】</h2>
<ol>
<li>
<p>概述：</p>
<ul>
<li><code>$refs</code>用于 ：<strong>父→子。</strong></li>
<li><code>$parent</code>用于：<strong>子→父。</strong></li>
</ul>
</li>
<li>
<p>原理如下：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>$refs</code></td>
<td>值为对象，包含所有被<code>ref</code>属性标识的<code>DOM</code>元素或组件实例。</td>
</tr>
<tr>
<td><code>$parent</code></td>
<td>值为对象，当前组件的父组件实例对象。</td>
</tr>
</tbody>
</table>
</li>
</ol>
<h2 id="67-provideinject">6.7. 【provide、inject】</h2>
<ol>
<li>
<p>概述：实现<strong>祖孙组件</strong>直接通信</p>
</li>
<li>
<p>具体使用：</p>
<ul>
<li>在祖先组件中通过<code>provide</code>配置向后代组件提供数据</li>
<li>在后代组件中通过<code>inject</code>配置来声明接收数据</li>
</ul>
</li>
<li>
<p>具体编码：</p>
<p>【第一步】父组件中，使用<code>provide</code>提供数据</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue">   <span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;father&#34;</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">父组件</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">资产</span><span class="err">：</span><span class="p">{{</span> <span class="nx">money</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">汽车</span><span class="err">：</span><span class="p">{{</span> <span class="nx">car</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">button</span> <span class="err">@</span><span class="na">click</span><span class="o">=</span><span class="s">&#34;money += 1&#34;</span><span class="p">&gt;</span><span class="nx">资产</span><span class="o">+</span><span class="mi">1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">button</span> <span class="err">@</span><span class="na">click</span><span class="o">=</span><span class="s">&#34;car.price += 1&#34;</span><span class="p">&gt;</span><span class="nx">汽车价格</span><span class="o">+</span><span class="mi">1</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">Child</span><span class="p">/&gt;</span>
     <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
   <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
   
   <span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;Father&#34;</span><span class="p">&gt;</span>
     <span class="kr">import</span> <span class="nx">Child</span> <span class="nx">from</span> <span class="s1">&#39;./Child.vue&#39;</span>
     <span class="kr">import</span> <span class="p">{</span> <span class="nx">ref</span><span class="p">,</span><span class="nx">reactive</span><span class="p">,</span><span class="nx">provide</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;vue&#34;</span><span class="p">;</span>
     <span class="c1">// 数据
</span><span class="c1"></span>     <span class="kd">let</span> <span class="nx">money</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
     <span class="kd">let</span> <span class="nx">car</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span>
       <span class="nx">brand</span><span class="o">:</span><span class="s1">&#39;奔驰&#39;</span><span class="p">,</span>
       <span class="nx">price</span><span class="o">:</span><span class="mi">100</span>
     <span class="p">})</span>
     <span class="c1">// 用于更新money的方法
</span><span class="c1"></span>     <span class="kd">function</span> <span class="nx">updateMoney</span><span class="p">(</span><span class="nx">value</span><span class="o">:</span><span class="nx">number</span><span class="p">){</span>
       <span class="nx">money</span><span class="p">.</span><span class="nx">value</span> <span class="o">+=</span> <span class="nx">value</span>
     <span class="p">}</span>
     <span class="c1">// 提供数据
</span><span class="c1"></span>     <span class="nx">provide</span><span class="p">(</span><span class="s1">&#39;moneyContext&#39;</span><span class="p">,{</span><span class="nx">money</span><span class="p">,</span><span class="nx">updateMoney</span><span class="p">})</span>
     <span class="nx">provide</span><span class="p">(</span><span class="s1">&#39;car&#39;</span><span class="p">,</span><span class="nx">car</span><span class="p">)</span>
   <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意：子组件中不用编写任何东西，是不受到任何打扰的</p>
</blockquote>
<p>【第二步】孙组件中使用<code>inject</code>配置项接受数据。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue">   <span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;grand-child&#34;</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">我是孙组件</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">资产</span><span class="err">：</span><span class="p">{{</span> <span class="nx">money</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span><span class="nx">汽车</span><span class="err">：</span><span class="p">{{</span> <span class="nx">car</span> <span class="p">}}&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">button</span> <span class="nt">@click</span><span class="s">=&#34;updateMoney(6)&#34;</span><span class="p">&gt;</span><span class="na">点我</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
     <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
   <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
   
   <span class="p">&lt;</span><span class="nt">script</span> <span class="na">setup</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;ts&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;GrandChild&#34;</span><span class="p">&gt;</span>
     <span class="kr">import</span> <span class="p">{</span> <span class="nx">inject</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;vue&#39;</span><span class="p">;</span>
     <span class="c1">// 注入数据
</span><span class="c1"></span>    <span class="kd">let</span> <span class="p">{</span><span class="nx">money</span><span class="p">,</span><span class="nx">updateMoney</span><span class="p">}</span> <span class="o">=</span> <span class="nx">inject</span><span class="p">(</span><span class="s1">&#39;moneyContext&#39;</span><span class="p">,{</span><span class="nx">money</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="nx">updateMoney</span><span class="o">:</span><span class="p">(</span><span class="nx">x</span><span class="o">:</span><span class="nx">number</span><span class="p">)=&gt;{}})</span>
     <span class="kd">let</span> <span class="nx">car</span> <span class="o">=</span> <span class="nx">inject</span><span class="p">(</span><span class="s1">&#39;car&#39;</span><span class="p">)</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="68-pinia">6.8. 【pinia】</h2>
<p>参考之前<code>pinia</code>部分的讲解</p>
<h2 id="69-slot">6.9. 【slot】</h2>
<h3 id="1-默认插槽">1. 默认插槽</h3>
<p><img src="/images/default_slot.png" alt="default_slot" title="default_slot"></p>
<!-- raw HTML omitted -->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="nx">父组件中</span><span class="err">：</span>
        <span class="p">&lt;</span><span class="nt">Category</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;今日热门游戏&#34;</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;g in games&#34; :key=&#34;g.id&#34;&gt;{{ g.name }}&lt;/li&gt;
</span><span class="s">          &lt;/ul&gt;
</span><span class="s">        &lt;/Category&gt;
</span><span class="s">子组件中：
</span><span class="s">        &lt;template&gt;
</span><span class="s">          &lt;div class=&#34;item&#34;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;{{</span> <span class="nx">title</span> <span class="p">}}&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
            <span class="c">&lt;!--</span> <span class="nx">默认插槽</span> <span class="o">--&gt;</span>
            <span class="p">&lt;</span><span class="nt">slot</span><span class="p">&gt;&lt;/</span><span class="nt">slot</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="2-具名插槽">2. 具名插槽</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="nx">父组件中</span><span class="err">：</span>
        <span class="p">&lt;</span><span class="nt">Category</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;今日热门游戏&#34;</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">template</span> <span class="na">v</span><span class="nt">-slot</span><span class="o">:</span><span class="na">s1</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
              <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;g in games&#34; :key=&#34;g.id&#34;&gt;{{ g.name }}&lt;/li&gt;
</span><span class="s">            &lt;/ul&gt;
</span><span class="s">          &lt;/template&gt;
</span><span class="s">          &lt;template #s2&gt;
</span><span class="s">            &lt;a href=&#34;&#34;&gt;更多&lt;/a&gt;
</span><span class="s">          &lt;/template&gt;
</span><span class="s">        &lt;/Category&gt;
</span><span class="s">子组件中：
</span><span class="s">        &lt;template&gt;
</span><span class="s">          &lt;div class=&#34;item&#34;&gt;
</span><span class="s">            &lt;h3&gt;{{ title }}&lt;/h3&gt;
</span><span class="s">            &lt;slot name=&#34;s1&#34;&gt;&lt;/slot&gt;
</span><span class="s">            &lt;slot name=&#34;s2&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">slot</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="3-作用域插槽">3. 作用域插槽</h3>
<ol>
<li>
<p>理解：<!-- raw HTML omitted -->数据在组件的自身，但根据数据生成的结构需要组件的使用者来决定。<!-- raw HTML omitted -->（新闻数据在<code>News</code>组件中，但使用数据所遍历出来的结构由<code>App</code>组件决定）</p>
</li>
<li>
<p>具体编码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="nx">父组件中</span><span class="err">：</span>
      <span class="p">&lt;</span><span class="nt">Game</span> <span class="nt">v-slot</span><span class="s">=&#34;params&#34;&gt;
</span><span class="s">      &lt;!-- &lt;Game v-slot</span><span class="nt">:default</span><span class="s">=&#34;params&#34;</span><span class="p">&gt;</span> <span class="err">--</span><span class="p">&gt;</span>
      <span class="c">&lt;!--</span> <span class="p">&lt;</span><span class="nt">Game</span> <span class="err">#</span><span class="na">default</span><span class="o">=</span><span class="s">&#34;params&#34;</span><span class="p">&gt;</span> <span class="o">--&gt;</span>
        <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">li</span> <span class="nt">v-for</span><span class="s">=&#34;g in params.games&#34; :key=&#34;g.id&#34;&gt;{{ g.name }}&lt;/li&gt;
</span><span class="s">        &lt;/ul&gt;
</span><span class="s">      &lt;/Game&gt;
</span><span class="s">   
</span><span class="s">子组件中：
</span><span class="s">      &lt;template&gt;
</span><span class="s">        &lt;div class=&#34;category&#34;&gt;
</span><span class="s">          &lt;h2&gt;今日游戏榜单&lt;/h2&gt;
</span><span class="s">          &lt;slot :games=&#34;games&#34; a=&#34;哈哈&#34;&gt;&lt;/slot&gt;
</span><span class="s">        &lt;/div&gt;
</span><span class="s">      &lt;/template&gt;
</span><span class="s">   
</span><span class="s">      &lt;script setup lang=&#34;ts&#34; name=&#34;Category&#34;</span><span class="p">&gt;</span>
        <span class="na">import</span> <span class="p">{</span><span class="na">reactive</span><span class="p">}</span> <span class="na">from</span> <span class="err">&#39;</span><span class="na">vue</span><span class="err">&#39;</span>
        <span class="na">let</span> <span class="na">games </span><span class="o">=</span> <span class="na">reactive</span><span class="err">([</span>
          <span class="p">{</span><span class="na">id</span><span class="o">:</span><span class="err">&#39;</span><span class="na">asgdytsa01</span><span class="err">&#39;,</span><span class="na">name</span><span class="o">:</span><span class="err">&#39;</span><span class="na">英雄联盟</span><span class="err">&#39;</span><span class="p">}</span><span class="err">,</span>
          <span class="p">{</span><span class="na">id</span><span class="o">:</span><span class="err">&#39;</span><span class="na">asgdytsa02</span><span class="err">&#39;,</span><span class="na">name</span><span class="o">:</span><span class="err">&#39;</span><span class="na">王者荣耀</span><span class="err">&#39;</span><span class="p">}</span><span class="err">,</span>
          <span class="p">{</span><span class="na">id</span><span class="o">:</span><span class="err">&#39;</span><span class="na">asgdytsa03</span><span class="err">&#39;,</span><span class="na">name</span><span class="o">:</span><span class="err">&#39;</span><span class="na">红色警戒</span><span class="err">&#39;</span><span class="p">}</span><span class="err">,</span>
          <span class="p">{</span><span class="na">id</span><span class="o">:</span><span class="err">&#39;</span><span class="na">asgdytsa04</span><span class="err">&#39;,</span><span class="na">name</span><span class="o">:</span><span class="err">&#39;</span><span class="na">斗罗大陆</span><span class="err">&#39;</span><span class="p">}</span>
        <span class="err">])</span>
      <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h1 id="7-其它-api">7. 其它 API</h1>
<h2 id="71shallowref-与-shallowreactive-">7.1.【shallowRef 与 shallowReactive 】</h2>
<h3 id="shallowref"><code>shallowRef</code></h3>
<ol>
<li>
<p>作用：创建一个响应式数据，但只对顶层属性进行响应式处理。</p>
</li>
<li>
<p>用法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">myVar</span> <span class="o">=</span> <span class="nx">shallowRef</span><span class="p">(</span><span class="nx">initialValue</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>特点：只跟踪引用值的变化，不关心值内部的属性变化。</p>
</li>
</ol>
<h3 id="shallowreactive"><code>shallowReactive</code></h3>
<ol>
<li>
<p>作用：创建一个浅层响应式对象，只会使对象的最顶层属性变成响应式的，对象内部的嵌套属性则不会变成响应式的</p>
</li>
<li>
<p>用法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">myObj</span> <span class="o">=</span> <span class="nx">shallowReactive</span><span class="p">({</span> <span class="p">...</span> <span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>特点：对象的顶层属性是响应式的，但嵌套对象的属性不是。</p>
</li>
</ol>
<h3 id="总结">总结</h3>
<blockquote>
<p>通过使用 <a href="https://cn.vuejs.org/api/reactivity-advanced.html#shallowref"><code>shallowRef()</code></a> 和 <a href="https://cn.vuejs.org/api/reactivity-advanced.html#shallowreactive"><code>shallowReactive()</code></a> 来绕开深度响应。浅层式 <code>API</code> 创建的状态只在其顶层是响应式的，对所有深层的对象不会做任何处理，避免了对每一个内部属性做响应式所带来的性能成本，这使得属性的访问变得更快，可提升性能。</p>
</blockquote>
<h2 id="72readonly-与-shallowreadonly">7.2.【readonly 与 shallowReadonly】</h2>
<h3 id="readonly"><strong><code>readonly</code></strong></h3>
<ol>
<li>
<p>作用：用于创建一个对象的深只读副本。</p>
</li>
<li>
<p>用法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">original</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span> <span class="p">...</span> <span class="p">});</span>
<span class="kr">const</span> <span class="nx">readOnlyCopy</span> <span class="o">=</span> <span class="nx">readonly</span><span class="p">(</span><span class="nx">original</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>特点：</p>
<ul>
<li>对象的所有嵌套属性都将变为只读。</li>
<li>任何尝试修改这个对象的操作都会被阻止（在开发模式下，还会在控制台中发出警告）。</li>
</ul>
</li>
<li>
<p>应用场景：</p>
<ul>
<li>创建不可变的状态快照。</li>
<li>保护全局状态或配置不被修改。</li>
</ul>
</li>
</ol>
<h3 id="shallowreadonly"><strong><code>shallowReadonly</code></strong></h3>
<ol>
<li>
<p>作用：与 <code>readonly</code> 类似，但只作用于对象的顶层属性。</p>
</li>
<li>
<p>用法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">original</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span> <span class="p">...</span> <span class="p">});</span>
<span class="kr">const</span> <span class="nx">shallowReadOnlyCopy</span> <span class="o">=</span> <span class="nx">shallowReadonly</span><span class="p">(</span><span class="nx">original</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>特点：</p>
<ul>
<li>
<p>只将对象的顶层属性设置为只读，对象内部的嵌套属性仍然是可变的。</p>
</li>
<li>
<p>适用于只需保护对象顶层属性的场景。</p>
</li>
</ul>
</li>
</ol>
<h2 id="73toraw-与-markraw">7.3.【toRaw 与 markRaw】</h2>
<h3 id="toraw"><code>toRaw</code></h3>
<ol>
<li>
<p>作用：用于获取一个响应式对象的原始对象， <code>toRaw</code> 返回的对象不再是响应式的，不会触发视图更新。</p>
<blockquote>
<p>官网描述：这是一个可以用于临时读取而不引起代理访问/跟踪开销，或是写入而不触发更改的特殊方法。不建议保存对原始对象的持久引用，请谨慎使用。</p>
</blockquote>
<blockquote>
<p>何时使用？ —— 在需要将响应式对象传递给非 <code>Vue</code> 的库或外部系统时，使用 <code>toRaw</code> 可以确保它们收到的是普通对象</p>
</blockquote>
</li>
<li>
<p>具体编码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">reactive</span><span class="p">,</span><span class="nx">toRaw</span><span class="p">,</span><span class="nx">markRaw</span><span class="p">,</span><span class="nx">isReactive</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;vue&#34;</span><span class="p">;</span>
   
<span class="cm">/* toRaw */</span>
<span class="c1">// 响应式对象
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">person</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;tony&#39;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">18</span><span class="p">})</span>
<span class="c1">// 原始对象
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">rawPerson</span> <span class="o">=</span> <span class="nx">toRaw</span><span class="p">(</span><span class="nx">person</span><span class="p">)</span>
   
   
<span class="cm">/* markRaw */</span>
<span class="kd">let</span> <span class="nx">citysd</span> <span class="o">=</span> <span class="nx">markRaw</span><span class="p">([</span>
  <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;asdda01&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;北京&#39;</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;asdda02&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;上海&#39;</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;asdda03&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;天津&#39;</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;asdda04&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;重庆&#39;</span><span class="p">}</span>
<span class="p">])</span>
<span class="c1">// 根据原始对象citys去创建响应式对象citys2 —— 创建失败，因为citys被markRaw标记了
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">citys2</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">(</span><span class="nx">citys</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">isReactive</span><span class="p">(</span><span class="nx">person</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">isReactive</span><span class="p">(</span><span class="nx">rawPerson</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">isReactive</span><span class="p">(</span><span class="nx">citys</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">isReactive</span><span class="p">(</span><span class="nx">citys2</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h3 id="markraw"><code>markRaw</code></h3>
<ol>
<li>
<p>作用：标记一个对象，使其<strong>永远不会</strong>变成响应式的。</p>
<blockquote>
<p>例如使用<code>mockjs</code>时，为了防止误把<code>mockjs</code>变为响应式对象，可以使用 <code>markRaw</code> 去标记<code>mockjs</code></p>
</blockquote>
</li>
<li>
<p>编码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="cm">/* markRaw */</span>
<span class="kd">let</span> <span class="nx">citys</span> <span class="o">=</span> <span class="nx">markRaw</span><span class="p">([</span>
  <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;asdda01&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;北京&#39;</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;asdda02&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;上海&#39;</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;asdda03&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;天津&#39;</span><span class="p">},</span>
  <span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="s1">&#39;asdda04&#39;</span><span class="p">,</span><span class="nx">name</span><span class="o">:</span><span class="s1">&#39;重庆&#39;</span><span class="p">}</span>
<span class="p">])</span>
<span class="c1">// 根据原始对象citys去创建响应式对象citys2 —— 创建失败，因为citys被markRaw标记了
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">citys2</span> <span class="o">=</span> <span class="nx">reactive</span><span class="p">(</span><span class="nx">citys</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="74customref">7.4.【customRef】</h2>
<p>作用：创建一个自定义的<code>ref</code>，并对其依赖项跟踪和更新触发进行逻辑控制。</p>
<p>实现防抖效果（<code>useSumRef.ts</code>）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-typescript" data-lang="typescript"><span class="kr">import</span> <span class="p">{</span><span class="nx">customRef</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;vue&#34;</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span><span class="p">(</span><span class="nx">initValue</span>:<span class="kt">string</span><span class="p">,</span><span class="nx">delay</span>:<span class="kt">number</span><span class="p">){</span>
  <span class="kd">let</span> <span class="nx">msg</span> <span class="o">=</span> <span class="nx">customRef</span><span class="p">((</span><span class="nx">track</span><span class="p">,</span><span class="nx">trigger</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="kd">let</span> <span class="nx">timer</span>:<span class="kt">number</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">get</span><span class="p">(){</span>
        <span class="nx">track</span><span class="p">()</span> <span class="c1">// 告诉Vue数据msg很重要，要对msg持续关注，一旦变化就更新
</span><span class="c1"></span>        <span class="k">return</span> <span class="nx">initValue</span>
      <span class="p">},</span>
      <span class="nx">set</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timer</span><span class="p">)</span>
        <span class="nx">timer</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">initValue</span> <span class="o">=</span> <span class="nx">value</span>
          <span class="nx">trigger</span><span class="p">()</span> <span class="c1">//通知Vue数据msg变化了
</span><span class="c1"></span>        <span class="p">},</span> <span class="nx">delay</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">})</span> 
  <span class="k">return</span> <span class="p">{</span><span class="nx">msg</span><span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>组件中使用：</p>
<h1 id="8-vue3新组件">8. Vue3新组件</h1>
<h2 id="81-teleport">8.1. 【Teleport】</h2>
<ul>
<li>什么是Teleport？—— Teleport 是一种能够将我们的<strong>组件html结构</strong>移动到指定位置的技术。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">teleport</span> <span class="na">to</span><span class="o">=</span><span class="s">&#39;body&#39;</span> <span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;modal&#34;</span> <span class="na">v-show</span><span class="o">=</span><span class="s">&#34;isShow&#34;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>我是一个弹窗<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>我是弹窗中的一些内容<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">button</span> <span class="err">@</span><span class="na">click</span><span class="o">=</span><span class="s">&#34;isShow = false&#34;</span><span class="p">&gt;</span>关闭弹窗<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">teleport</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="82-suspense">8.2. 【Suspense】</h2>
<ul>
<li>等待异步组件时渲染一些额外内容，让应用有更好的用户体验</li>
<li>使用步骤：
<ul>
<li>异步引入组件</li>
<li>使用<code>Suspense</code>包裹组件，并配置好<code>default</code> 与 <code>fallback</code></li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-tsx" data-lang="tsx"><span class="kr">import</span> <span class="p">{</span> <span class="nx">defineAsyncComponent</span><span class="p">,</span><span class="nx">Suspense</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;vue&#34;</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">Child</span> <span class="o">=</span> <span class="nx">defineAsyncComponent</span><span class="p">(()</span><span class="o">=&gt;</span><span class="kr">import</span><span class="p">(</span><span class="s1">&#39;./Child.vue&#39;</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vue" data-lang="vue"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;app&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">我是App组件</span><span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">Suspense</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">template</span> <span class="na">v</span><span class="nt">-slot</span><span class="o">:</span><span class="na">default</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">Child</span><span class="p">/&gt;</span>
          <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">template</span> <span class="na">v</span><span class="nt">-slot</span><span class="o">:</span><span class="na">fallback</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span><span class="nx">加载中</span><span class="p">.......&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">Suspense</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="83全局api转移到应用对象">8.3.【全局API转移到应用对象】</h2>
<ul>
<li><code>app.component</code></li>
<li><code>app.config</code></li>
<li><code>app.directive</code></li>
<li><code>app.mount</code></li>
<li><code>app.unmount</code></li>
<li><code>app.use</code></li>
</ul>
<h2 id="84其他">8.4.【其他】</h2>
<ul>
<li>
<p>过渡类名 <code>v-enter</code> 修改为 <code>v-enter-from</code>、过渡类名 <code>v-leave</code> 修改为 <code>v-leave-from</code>。</p>
</li>
<li>
<p><code>keyCode</code> 作为 <code>v-on</code> 修饰符的支持。</p>
</li>
<li>
<p><code>v-model</code> 指令在组件上的使用已经被重新设计，替换掉了 <code>v-bind.sync。</code></p>
</li>
<li>
<p><code>v-if</code> 和 <code>v-for</code> 在同一个元素身上使用时的优先级发生了变化。</p>
</li>
<li>
<p>移除了<code>$on</code>、<code>$off</code> 和 <code>$once</code> 实例方法。</p>
</li>
<li>
<p>移除了过滤器 <code>filter</code>。</p>
</li>
<li>
<p>移除了<code>$children</code> 实例 <code>propert</code>。</p>
<p>&hellip;&hellip;</p>
</li>
</ul>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content"><a href="https://piaohua.github.io/" class="theme-link">piaohua</a></span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2025-08-30
        
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">License</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/vue3/">vue3</a>
          <a href="/tags/typescript/">typescript</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/learn/20250830-typescript-quick-start/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Typescript 极速梳理</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/tool/20250828-openresty-lua-redis-ip-black/">
            <span class="next-text nav-default">Openresty &#43; Lua &#43; Redis 实现动态IP黑名单</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

  
    <script src="https://giscus.app/client.js"
            data-repo="piaohua/piaohua.github.io"
            data-repo-id="MDEwOlJlcG9zaXRvcnkyODQ0MjQ4NDM="
            data-category="Announcements"
            data-category-id="DIC_kwDOEPP6i84ChN9S"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="preferred_color_scheme"
            data-lang="zh-CN"
            crossorigin="anonymous"
            async>
    </script>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:twopiao7@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://stackoverflow.com/" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://twitter.com/" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://facebook.com/" class="iconfont icon-facebook" title="facebook"></a>
      <a href="https://linkedin.com/" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://google.com/" class="iconfont icon-google" title="google"></a>
      <a href="https://github.com/piaohua/" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/people/piaohua-47" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/people/47269566/" class="iconfont icon-douban" title="douban"></a>
      <a href="https://getpocket.com/" class="iconfont icon-pocket" title="pocket"></a>
      <a href="https://tumblr.com/" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="https://instagram.com/" class="iconfont icon-instagram" title="instagram"></a>
      <a href="https://gitlab.com/" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="https://www.bilibili.com/" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="https://piaohua.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2020 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span><span><a href="https://piaohua.github.io/" class="theme-link">piaohua</a></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
